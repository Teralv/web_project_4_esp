!function(){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,n(o.key),o)}}function n(t){var n=function(t,n){if("object"!==e(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,"string");if("object"!==e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===e(n)?n:String(n)}var r=function(){function e(t,r,o){var i,u,a,c=this,l=o.handleCardClick,s=o.handleDeleteClick,f=o.handleAddLike,p=o.handleRemoveLike,y=o.userID;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i=this,a=function(e){return c._likesArray=e,c._likesArray},(u=n(u="updateLikes"))in i?Object.defineProperty(i,u,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[u]=a,this._name=t.name,this._link=t.link,this._id=t.id,this._likesArray=t.likes,this._cardLikes=this._likesArray.length,this._ownerId=t.owner._id,this._cardSelector=r,this._handleCardClick=l,this._handleDeleteClick=s,this._handleAddLike=f,this._handleRemoveLike=p,this._user=y,this._heartButton=document.querySelector(".element__heart"),this._heartNumber=document.querySelector(".element__like-counter")}var r,o;return r=e,(o=[{key:"_getTemplate",value:function(){return document.querySelector(this._cardSelector).content.querySelector(".element").cloneNode(!0)}},{key:"generateCard",value:function(){var e=this;this._element=this._getTemplate(),this._setEventListeners(),this._element.querySelector(".element__name").textContent=this._name,this._element.querySelector(".element__image").src=this._link,this._element.querySelector(".element__image").alt="Imagen de ".concat(this._name),this._heartNumber.textContent=this._cardLikes?this._cardLikes:"";var t=this._likesArray.some((function(t){return t._id===e._user}));return this._heartButton.classList.toggle("element__heart_black",t),this._element}},{key:"_setEventListeners",value:function(){var e=this;this._element.querySelector(".element__heart").addEventListener("click",(function(){e._likesArray.some((function(t){return t._id===e._user}))?e._handleRemoveLike({id:e._id}):e._handleAddLike({id:e._id})})),this._element.querySelector(".element__trash").addEventListener("click",(function(){e._handleTrashBtn()})),this._element.querySelector(".element__trash").addEventListener("click",(function(){e._handleRemoveLike({id:e._id})})),this._element.querySelector(".element__image").addEventListener("click",(function(){e._handleOpenImagePopup()}))}},{key:"_handleAddLike",value:function(){this._element.querySelector(".element__heart").classList.add("element__heart_black"),this._heartNumber.textContent=this._likesArray.length}},{key:"_handleRemoveLike",value:function(){this._element.querySelector(".element__heart").classList.remove("element__heart_black"),this._heartNumber.textContent=this._likesArray.length,"0"===this._cardLikes&&(this._heartNumber.textContent="")}},{key:"_handleTrashBtn",value:function(){this._element.remove()}},{key:"_handleOpenImagePopup",value:function(){this._handleCardClick(this._link,this._name)}}])&&t(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),e}();function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function u(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function a(e,t,n){return(t=c(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e){var t=function(e,t){if("object"!==o(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===o(t)?t:String(t)}var l=u((function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),a(this,"_showInputError",(function(e,t,n){var r=e.querySelector(".".concat(t.id,"-error"));t.classList.add("form__input_type_error"),r.textContent=n,r.classList.add("form__input-error_active")})),a(this,"_hideInputError",(function(e,t){var n=e.querySelector(".".concat(t.id,"-error"));t.classList.remove("form__input_type_error"),n.classList.remove("form__input-error_active"),n.textContent=""})),a(this,"_checkInputValidity",(function(e,t){t.validity.valid?n._hideInputError(e,t):n._showInputError(e,t,t.validationMessage)})),a(this,"_hasInvalidInput",(function(e){return e.some((function(e){return!e.validity.valid}))})),a(this,"_toggleButtonState",(function(e,t){n._hasInvalidInput(e)?t.classList.add("popup__btn_inactive"):t.classList.remove("popup__btn_inactive")})),a(this,"_setEventListeners",(function(e){var t=Array.from(e.querySelectorAll(".form__input")),r=e.querySelector(".popup__btn");n._toggleButtonState(t,r),t.forEach((function(o){o.addEventListener("input",(function(){n._checkInputValidity(e,o),n._toggleButtonState(t,r)}))}))})),a(this,"enableValidation",(function(){Array.from(document.querySelectorAll(".form")).forEach((function(e){var t=e.querySelector(".popup__btn");e.addEventListener("submit",(function(e){t.classList.add("popup__btn_inactive"),e.preventDefault()})),Array.from(e.querySelectorAll(".form__set")).forEach((function(e){n._setEventListeners(e)}))}))})),this._validation=t}));function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==s(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===s(o)?o:String(o)),r)}var o}var p=function(){function e(t,n){var r=t.data,o=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._dataArray=r,this.renderer=o,this._container=document.querySelector(n)}var t,n;return t=e,(n=[{key:"renderedItems",value:function(){var e=this;this._dataArray.forEach((function(t){e.renderer(t)}))}},{key:"addInitalItems",value:function(e){this._container.append(e)}},{key:"addItems",value:function(e){this._container.prepend(e)}}])&&f(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==y(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===y(o)?o:String(o)),r)}var o}var d=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._popupElement=document.querySelector(t)}var t,n;return t=e,(n=[{key:"open",value:function(){this._popupElement.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}},{key:"close",value:function(){this._popupElement.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}},{key:"_handleEscClose",value:function(e){if("Escape"===e.key)return this.close()}},{key:"_handleOutsideClick",value:function(e){(e.target.classList.contains("popup__section")||e.target.classList.contains("popup__background"))&&this.close()}},{key:"setEventListeners",value:function(){var e=this;this._popupElement.querySelector(".popup__close-btn").addEventListener("click",(function(){e.close()})),document.addEventListener("keydown",(function(t){e._handleEscClose(t)})),this._popupElement.addEventListener("click",(function(t){e._handleOutsideClick(t)}))}}])&&h(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==m(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==m(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===m(o)?o:String(o)),r)}var o}function b(){return b="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=S(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},b.apply(this,arguments)}function v(e,t){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},v(e,t)}function S(e){return S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},S(e)}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=S(r);if(o){var n=S(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===m(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=i.call(this,e))._popupImage=t._popupElement.querySelector(".image-popup__image"),t._popupTitle=t._popupElement.querySelector(".image-popup__title"),t}return t=u,(n=[{key:"open",value:function(e){var t=e.link,n=e.name;b(S(u.prototype),"open",this).call(this),this._popupImage.src=t,this._popupImage.alt="Imagen de ".concat(n),this._popupTitle.textContent=n,b(S(u.prototype),"setEventListeners",this).call(this)}}])&&_(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(d);function k(e){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},k(e)}function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==k(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==k(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===k(o)?o:String(o)),r)}var o}function E(){return E="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=j(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},E.apply(this,arguments)}function L(e,t){return L=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},L(e,t)}function j(e){return j=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},j(e)}var P=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&L(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=j(r);if(o){var n=j(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===k(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function u(e){var t,n=e.popupSelector,r=e.submitCallback;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=i.call(this,n))._form=t._popupElement.querySelector(".form"),t._buttonSubmit=t._popupElement.querySelector(".popup__btn"),t._handleFormSubmit=r,t}return t=u,(n=[{key:"_getInputValues",value:function(){var e=this;return this._inputList=this._form.querySelectorAll(".form__input"),this.formValues={},this._inputList.forEach((function(t){e.formValues[t.name]=t.value})),this.formValues}},{key:"setEventListeners",value:function(){var e=this;E(j(u.prototype),"setEventListeners",this).call(this),this._form.addEventListener("submit",(function(t){t.preventDefault(),e._handleFormSubmit(e._getInputValues()),e.close()}))}},{key:"close",value:function(){E(j(u.prototype),"close",this).call(this),this._form.reset(),this._popupElement.querySelector(".popup__btn").classList.add("popup__btn_inactive")}}])&&w(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(d);function O(e){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},O(e)}function q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==O(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==O(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===O(o)?o:String(o)),r)}var o}var C=function(){function e(t){var n=t.nameSelector,r=t.aboutSelector,o=t.avatarSelector,i=t.userID;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._username=n,this._about=r,this._avatarSelector=o,this._userID=i,this._nameInput=document.querySelector("#name-input"),this._aboutInput=document.querySelector("#about-input")}var t,n;return t=e,(n=[{key:"getUserInfo",value:function(){return{name:this._nameInput.textContent,about:this._jobInput.textContent}}},{key:"setUserInfo",value:function(e){var t=e.username,n=e.about;this._username.textContent=t,this._about.textContent=n}},{key:"setUserAvatar",value:function(e){this._avatarSelector.src=e}}])&&q(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function I(e){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I(e)}function R(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==I(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==I(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===I(o)?o:String(o)),r)}var o}var T=function(){function e(t){var n=t.baseURL,r=t.headers;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._baseURL=n,this._headers=r}var t,n;return t=e,(n=[{key:"getInitialCards",value:function(){return fetch("".concat(this._baseURL,"/cards"),{method:"GET",headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"addNewCard",value:function(e,t){return fetch("".concat(this._baseURL,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"deleteCard",value:function(e){return fetch("".concat(this._baseURL,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"getUserInfo",value:function(){return fetch("".concat(this._baseURL,"/users/me"),{method:"GET",headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"editProfileInfo",value:function(e,t){return fetch("".concat(this._baseURL,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"addLike",value:function(e){return fetch("".concat(this._baseURL,"/likes/").concat(e),{method:"PUT",headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"deleteLike",value:function(e){return fetch("".concat(this._baseURL,"/likes/").concat(e),{method:"DELETE",headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"avatarImage",value:function(e){return fetch("".concat(this._baseURL,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}}])&&R(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function A(e){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},A(e)}function x(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==A(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==A(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===A(o)?o:String(o)),r)}var o}function B(){return B="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=U(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},B.apply(this,arguments)}function D(e,t){return D=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},D(e,t)}function U(e){return U=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},U(e)}var N=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&D(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=U(r);if(o){var n=U(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===A(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function u(e){var t,n=e.popupSelector,r=e.handleFormSubmit,o=e.submitButton;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=i.call(this,n))._handleFormSubmit=r,t._submitButton=o,t}return t=u,(n=[{key:"close",value:function(){B(U(u.prototype),"close",this).call(this),this.renderLoading(!1)}},{key:"setSubmitAction",value:function(e){this._handleFormSubmit=e}},{key:"renderLoading",value:function(e){this._submitButton.textContent=e?"Saving...":this._submitButton.dataset.textcontent}},{key:"setEventListeners",value:function(){var e=this;B(U(u.prototype),"setEventListeners",this).call(this),this._submitButton.addEventListener("click",(function(t){t.preventDefault(),e.renderLoading(!0),e._handleFormSubmit()}))}}])&&x(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(d),V=document.querySelector(".root").querySelector(".page"),F=V.querySelector(".profile__author"),J=V.querySelector(".profile__about-me"),G=(V.querySelector(".profile__container"),V.querySelector("#popup__avatar-image"),V.querySelector("#popup__profile-form")),H=V.querySelector("#popup__profile"),z=(G.querySelector("#name-input"),G.querySelector("#about-input"),H.querySelector(".popup__profile-close-btn"),V.querySelector(".profile__edit-btn")),M=H.querySelector(".popup__btn"),K=V.querySelector("#popup__places-form"),Q=V.querySelector("#popup__cards"),W=(Q.querySelector(".popup__places-close-btn"),V.querySelector(".profile__add-btn"));K.querySelector(".popup__place"),K.querySelector(".popup__url"),K.querySelector(".popup__btn"),V.querySelector("#image-popup"),document.querySelector(".profile__container").addEventListener("click",(function(){document.querySelector("#popup__avatar-image").classList.add("popup_opened")}));var X=new C({nameSelector:F,aboutSelector:J,avatarSelector:document.querySelector(".profile__photo")}),Y=new N({popupSelector:"#popup__delete",submitButton:document.querySelector(".popup__confirm-btn")}),Z=new g("#image-popup");Z.setEventListeners(),Y.setEventListeners();var $=new T({baseURL:"https://around.nomoreparties.co/v1/web_es_07",headers:{authorization:"b7e71284-4020-44f4-a80f-43722c5b3ece","Content-Type":"application/json"}}),ee=new P({popupSelector:"#popup__profile",submitCallback:function(e){$.editProfileInfo(e.name,e.about).then((function(e){X.setUserInfo({username:e.name,about:e.about}),ee.close()})).catch((function(e){return console.log(e)}))}});function te(e){var t=new r(e,"#element-template",{handleCardClick:function(e){var t=e.name,n=e.link;Z.open({name:t,link:n})},handleDeleteClick:function(e){var n=e.id;Y.open(),Y.setSubmitAction((function(){$.deleteCard(n).then((function(){Y.close(),t._handleTrashBtn()})).catch((function(e){return console.log(e)}))}))},handleAddLike:function(e){var n=e.id;$.addLike(n).then((function(e){t.updateLikes(e.likes),t._handleAddLike()})).catch((function(e){return console.log(e)}))},handleRemoveLike:function(e){var n=e.id;$.deleteLike(n).then((function(e){t.updateLikes(e.likes),t._handleRemoveLike()})).catch((function(e){return console.log(e)}))},userID:X.userId});return t.generateCard()}ee.setEventListeners(),$.getUserInfo().then((function(e){X.setUserInfo({username:e.name,about:e.about}),X.userID=e._id})).then((function(){$.getInitialCards().then((function(e){var t=new p({data:e,renderer:function(e){var n=te(e);t.addInitalItems(n),console.log(n)}},"#elements");t.renderedItems();var n=new P({popupSelector:"#popup__cards",submitCallback:function(e){$.addNewCard(e.name,e.popup__link).then((function(e){var r=te(e);t.addItems(r),n.close()})).catch((function(e){return console.log(e)}))}});n.setEventListeners()}))})),W.addEventListener("click",(function(){Q.classList.toggle("popup_opened")})),z.addEventListener("click",(function(){H.classList.add("popup_opened"),M.classList.add("popup__btn_inactive")})),new l(document).enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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R0FDM0IsSUFDQzZILE1BQUssV0FDSmtDLEVBQUlzQixrQkFBa0J4RCxNQUFLLFNBQUNDLEdBQzFCLElBQU13RCxFQUFjLElBQUlwSCxFQUFRLENBQzlCbkYsS0FBTStJLEVBQ04xRCxTQUFVLFNBQUNyRixHQUNULElBQU0wTCxFQUFjRCxHQUFXekwsR0FDL0J1TSxFQUFZQyxlQUFlZCxHQUMzQkgsUUFBUUMsSUFBSUUsRUFDZCxHQUNDLGFBRUhhLEVBQVlFLGdCQUVaLElBQU1DLEVBQVUsSUFBSTNGLEVBQWMsQ0FDaENsQixjQUFlLGdCQUNmbUIsZUFBZ0IsU0FBQ2hILEdBQ2ZnTCxFQUNHMkIsV0FBVzNNLEVBQUtjLEtBQU1kLEVBQWtCLGFBQ3hDOEksTUFBSyxTQUFDOEQsR0FDTCxJQUFNQyxFQUFpQnBCLEdBQVdtQixHQUNsQ0wsRUFBWU8sU0FBU0QsR0FDckJILEVBQVF6RyxPQUNWLElBQ0NvRixPQUFNLFNBQUNDLEdBQUcsT0FBS0MsUUFBUUMsSUFBSUYsRUFBSSxHQUNwQyxJQUdGb0IsRUFBUTNCLG1CQUVWLEdBQ0YsSUE2RkFKLEVBQVd2SCxpQkFBaUIsU0FKQSxXQUMxQnNILEVBQVl6SCxVQUFVQyxPQUFPLGVBQy9CLElBU0FxSCxFQUFlbkgsaUJBQWlCLFNBTFAsV0FDdkJrSCxFQUFhckgsVUFBVU0sSUFBSSxnQkFDM0JpSCxFQUFpQnZILFVBQVVNLElBQUksc0JBQ2pDLElBWW1CLElBQUlFLEVBQWMxQixVQUcxQmdMLGtCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNF9lc3AvLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzRfZXNwLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80X2VzcC8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNF9lc3AvLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80X2VzcC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzRfZXNwLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80X2VzcC8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzRfZXNwLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzRfZXNwLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzRfZXNwLy4vc3JjL3BhZ2UvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKGRhdGEsIGNhcmRTZWxlY3RvciwgeyBoYW5kbGVDYXJkQ2xpY2ssIGhhbmRsZURlbGV0ZUNsaWNrLCBoYW5kbGVBZGRMaWtlLCBoYW5kbGVSZW1vdmVMaWtlLCB1c2VySUQgfSkge1xuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcbiAgICB0aGlzLl9pZCA9IGRhdGEuaWQ7XG4gICAgdGhpcy5fbGlrZXNBcnJheSA9IGRhdGEubGlrZXM7XG4gICAgdGhpcy5fY2FyZExpa2VzID0gdGhpcy5fbGlrZXNBcnJheS5sZW5ndGg7XG4gICAgdGhpcy5fb3duZXJJZCA9IGRhdGEub3duZXIuX2lkO1xuXG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xuXG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrID0gaGFuZGxlRGVsZXRlQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlQWRkTGlrZSA9IGhhbmRsZUFkZExpa2U7XG4gICAgdGhpcy5faGFuZGxlUmVtb3ZlTGlrZSA9IGhhbmRsZVJlbW92ZUxpa2U7XG5cbiAgICB0aGlzLl91c2VyID0gdXNlcklEO1xuXG4gICAgdGhpcy5faGVhcnRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudF9faGVhcnQnKTtcbiAgICB0aGlzLl9oZWFydE51bWJlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50X19saWtlLWNvdW50ZXInKTtcbiAgfVxuXG4gIF9nZXRUZW1wbGF0ZSgpIHtcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXG4gICAgICAuY29udGVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50JylcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG5cbiAgICByZXR1cm4gY2FyZEVsZW1lbnQ7XG4gIH1cblxuICBnZW5lcmF0ZUNhcmQoKSB7XG4gICAgdGhpcy5fZWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmVsZW1lbnRfX25hbWUnKS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudF9faW1hZ2UnKS5zcmMgPSB0aGlzLl9saW5rO1xuICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmVsZW1lbnRfX2ltYWdlJykuYWx0ID0gYEltYWdlbiBkZSAke3RoaXMuX25hbWV9YDtcbiAgICB0aGlzLl9oZWFydE51bWJlci50ZXh0Q29udGVudCA9IHRoaXMuX2NhcmRMaWtlcyA/IHRoaXMuX2NhcmRMaWtlcyA6ICcnO1xuXG4gICAgY29uc3QgaGFzVXNlckxpa2VkID0gdGhpcy5fbGlrZXNBcnJheS5zb21lKChsaWtlKSA9PiBsaWtlLl9pZCA9PT0gdGhpcy5fdXNlcik7XG4gICAgdGhpcy5faGVhcnRCdXR0b24uY2xhc3NMaXN0LnRvZ2dsZSgnZWxlbWVudF9faGVhcnRfYmxhY2snLCBoYXNVc2VyTGlrZWQpO1xuXG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudF9faGVhcnQnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgIGNvbnN0IGhhc1VzZXJMaWtlZCA9IHRoaXMuX2xpa2VzQXJyYXkuc29tZSgobGlrZSkgPT4gbGlrZS5faWQgPT09IHRoaXMuX3VzZXIpO1xuICAgICAgICBpZiAoaGFzVXNlckxpa2VkKSB7XG4gICAgICAgICAgdGhpcy5faGFuZGxlUmVtb3ZlTGlrZSh7aWQ6IHRoaXMuX2lkfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5faGFuZGxlQWRkTGlrZSh7aWQ6IHRoaXMuX2lkfSk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmVsZW1lbnRfX3RyYXNoJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVUcmFzaEJ0bigpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudF9fdHJhc2gnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZVJlbW92ZUxpa2Uoe2lkOiB0aGlzLl9pZH0pO1xuICAgIH0pO1xuXG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudF9faW1hZ2UnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZU9wZW5JbWFnZVBvcHVwKCk7XG4gICAgfSk7XG4gIH1cblxuICBfaGFuZGxlQWRkTGlrZSgpIHtcbiAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50X19oZWFydCcpLmNsYXNzTGlzdC5hZGQoJ2VsZW1lbnRfX2hlYXJ0X2JsYWNrJyk7XG4gICAgdGhpcy5faGVhcnROdW1iZXIudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlc0FycmF5Lmxlbmd0aDtcbiAgfVxuXG4gIF9oYW5kbGVSZW1vdmVMaWtlKCkge1xuICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmVsZW1lbnRfX2hlYXJ0JykuY2xhc3NMaXN0LnJlbW92ZSgnZWxlbWVudF9faGVhcnRfYmxhY2snKTtcbiAgICB0aGlzLl9oZWFydE51bWJlci50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzQXJyYXkubGVuZ3RoO1xuICAgIGlmKHRoaXMuX2NhcmRMaWtlcyA9PT0gJzAnKSB7XG4gICAgICB0aGlzLl9oZWFydE51bWJlci50ZXh0Q29udGVudCA9ICcnO1xuICAgIH1cbiAgfVxuXG4gIHVwZGF0ZUxpa2VzID0gKHJlc0FycmF5KSA9PiB7XG4gICAgdGhpcy5fbGlrZXNBcnJheSA9IHJlc0FycmF5O1xuICAgIHJldHVybiB0aGlzLl9saWtlc0FycmF5O1xuICB9O1xuXG4gIF9oYW5kbGVUcmFzaEJ0bigpIHtcbiAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xuICB9XG5cbiAgX2hhbmRsZU9wZW5JbWFnZVBvcHVwKCkge1xuICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayh0aGlzLl9saW5rLCB0aGlzLl9uYW1lKTtcbiAgfVxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3Rvcih2YWxpZGF0aW9uKSB7XG4gICAgdGhpcy5fdmFsaWRhdGlvbiA9IHZhbGlkYXRpb247XG4gIH1cblxuICBfc2hvd0lucHV0RXJyb3IgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlKSA9PiB7XG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKCdmb3JtX19pbnB1dF90eXBlX2Vycm9yJyk7XG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdmb3JtX19pbnB1dC1lcnJvcl9hY3RpdmUnKTtcbiAgfTtcblxuICBfaGlkZUlucHV0RXJyb3IgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCkgPT4ge1xuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnZm9ybV9faW5wdXRfdHlwZV9lcnJvcicpO1xuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdmb3JtX19pbnB1dC1lcnJvcl9hY3RpdmUnKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSAnJztcbiAgfTtcblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5ID0gKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQpID0+IHtcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCk7XG4gICAgfVxuICB9O1xuXG4gIF9oYXNJbnZhbGlkSW5wdXQgPSAoaW5wdXRMaXN0KSA9PiB7XG4gICAgcmV0dXJuIGlucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIHJldHVybiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkO1xuICAgIH0pO1xuICB9O1xuXG4gIF90b2dnbGVCdXR0b25TdGF0ZSA9IChpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQpID0+IHtcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkpIHtcbiAgICAgIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCgncG9wdXBfX2J0bl9pbmFjdGl2ZScpO1xuICAgIH0gZWxzZSB7XG4gICAgICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3BvcHVwX19idG5faW5hY3RpdmUnKTtcbiAgICB9XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMgPSAoZm9ybUVsZW1lbnQpID0+IHtcbiAgICBjb25zdCBpbnB1dExpc3QgPSBBcnJheS5mcm9tKGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5mb3JtX19pbnB1dCcpKTtcbiAgICBjb25zdCBidXR0b25FbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19idG4nKTtcblxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCk7XG5cbiAgICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50KTtcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgZW5hYmxlVmFsaWRhdGlvbiA9ICgpID0+IHtcbiAgICBjb25zdCBmb3JtTGlzdCA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmZvcm0nKSk7XG5cbiAgICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xuICAgICAgY29uc3QgYnV0dG9uRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fYnRuJyk7XG4gICAgICBmb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgICAgIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCgncG9wdXBfX2J0bl9pbmFjdGl2ZScpO1xuICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBmaWVsZHNldExpc3QgPSBBcnJheS5mcm9tKGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5mb3JtX19zZXQnKSk7XG5cbiAgICAgIGZpZWxkc2V0TGlzdC5mb3JFYWNoKChmaWVsZHNldCkgPT4ge1xuICAgICAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycyhmaWVsZHNldCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xuICBjb25zdHJ1Y3Rvcih7IGRhdGEsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XG4gICAgdGhpcy5fZGF0YUFycmF5ID0gZGF0YTtcbiAgICB0aGlzLnJlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XG4gIH1cblxuICByZW5kZXJlZEl0ZW1zKCkge1xuICAgIHRoaXMuX2RhdGFBcnJheS5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgdGhpcy5yZW5kZXJlcihpdGVtKTtcbiAgICB9KTtcbiAgfVxuXG4gIGFkZEluaXRhbEl0ZW1zKGVsZW1lbnQpIHtcbiAgICB0aGlzLl9jb250YWluZXIuYXBwZW5kKGVsZW1lbnQpO1xuICB9XG5cbiAgYWRkSXRlbXMoZWxlbWVudCkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xuICB9XG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcbiAgfVxuXG4gIG9wZW4oKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ3BvcHVwX29wZW5lZCcpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgncG9wdXBfb3BlbmVkJyk7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIF9oYW5kbGVFc2NDbG9zZShldnQpIHtcbiAgICBpZihldnQua2V5ID09PSAnRXNjYXBlJykge1xuICAgICAgcmV0dXJuIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH1cblxuICBfaGFuZGxlT3V0c2lkZUNsaWNrKGV2dCkge1xuICAgIGlmKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdwb3B1cF9fc2VjdGlvbicpIHx8IGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdwb3B1cF9fYmFja2dyb3VuZCcpKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fY2xvc2UtYnRuJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfSlcblxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoZXZ0KSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVFc2NDbG9zZShldnQpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2dCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlT3V0c2lkZUNsaWNrKGV2dCk7XG4gICAgfSk7XG4gIH1cbn0iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9wb3B1cEltYWdlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5pbWFnZS1wb3B1cF9faW1hZ2UnKTtcbiAgICB0aGlzLl9wb3B1cFRpdGxlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5pbWFnZS1wb3B1cF9fdGl0bGUnKTtcbiAgfVxuXG4gIG9wZW4oe2xpbmssIG5hbWV9KSB7XG4gICAgc3VwZXIub3BlbigpO1xuICAgIHRoaXMuX3BvcHVwSW1hZ2Uuc3JjID0gbGluaztcbiAgICB0aGlzLl9wb3B1cEltYWdlLmFsdCA9IGBJbWFnZW4gZGUgJHtuYW1lfWA7XG4gICAgdGhpcy5fcG9wdXBUaXRsZS50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxufSIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IsIHN1Ym1pdENhbGxiYWNrIH0pIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mb3JtJyk7XG4gICAgdGhpcy5fYnV0dG9uU3VibWl0ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fYnRuJylcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gc3VibWl0Q2FsbGJhY2s7XG4gIH1cblxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKCcuZm9ybV9faW5wdXQnKTtcbiAgICB0aGlzLmZvcm1WYWx1ZXMgPSB7fTtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIHRoaXMuZm9ybVZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xuICAgIH0pO1xuICAgIHJldHVybiB0aGlzLmZvcm1WYWx1ZXM7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH0pO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgICB0aGlzLl9mb3JtLnJlc2V0KCk7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fYnRuJykuY2xhc3NMaXN0LmFkZCgncG9wdXBfX2J0bl9pbmFjdGl2ZScpO1xuICB9XG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3Rvcih7IG5hbWVTZWxlY3RvciwgYWJvdXRTZWxlY3RvciwgYXZhdGFyU2VsZWN0b3IsIHVzZXJJRCB9KSB7XG4gICAgdGhpcy5fdXNlcm5hbWUgPSBuYW1lU2VsZWN0b3I7XG4gICAgdGhpcy5fYWJvdXQgPSBhYm91dFNlbGVjdG9yO1xuICAgIHRoaXMuX2F2YXRhclNlbGVjdG9yID0gIGF2YXRhclNlbGVjdG9yO1xuICAgIHRoaXMuX3VzZXJJRCA9IHVzZXJJRDtcblxuICAgIHRoaXMuX25hbWVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNuYW1lLWlucHV0Jyk7XG4gICAgdGhpcy5fYWJvdXRJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNhYm91dC1pbnB1dCcpO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IHRoaXMuX25hbWVJbnB1dC50ZXh0Q29udGVudCxcbiAgICAgIGFib3V0OiB0aGlzLl9qb2JJbnB1dC50ZXh0Q29udGVudFxuICAgIH07XG4gIH1cblxuICBzZXRVc2VySW5mbyhkYXRhKSB7XG4gICAgY29uc3Qge3VzZXJuYW1lLCBhYm91dH0gPSBkYXRhXG4gICAgdGhpcy5fdXNlcm5hbWUudGV4dENvbnRlbnQgPSB1c2VybmFtZTtcbiAgICB0aGlzLl9hYm91dC50ZXh0Q29udGVudCA9IGFib3V0O1xuICB9XG5cbiAgc2V0VXNlckF2YXRhcihhdmF0YXIpIHtcbiAgICB0aGlzLl9hdmF0YXJTZWxlY3Rvci5zcmMgPSBhdmF0YXJcbiAgfVxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKHtiYXNlVVJMLCBoZWFkZXJzfSkge1xuICAgIHRoaXMuX2Jhc2VVUkwgPSBiYXNlVVJMO1xuICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xuICB9XG5cbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVVJMfS9jYXJkc2AsIHtcbiAgICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcbiAgICB9KVxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICBpZihyZXMub2spIHtcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgICB9KTtcbiAgfVxuXG4gIGFkZE5ld0NhcmQobmFtZSwgbGluaykge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVVJMfS9jYXJkc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICBsaW5rOiBsaW5rXG4gICAgICB9KVxuICAgIH0pXG4gICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgIGlmKHJlcy5vaykge1xuICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgZGVsZXRlQ2FyZChjYXJkSUQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVSTH0vY2FyZHMvJHtjYXJkSUR9YCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KVxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICBpZihyZXMub2spIHtcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgICB9KTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVVJMfS91c2Vycy9tZWAsIHtcbiAgICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcbiAgICB9KVxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICBpZihyZXMub2spIHtcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgICB9KTtcbiAgfVxuXG4gIGVkaXRQcm9maWxlSW5mbyhuYW1lLCBhYm91dCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVVJMfS91c2Vycy9tZWAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgYWJvdXQ6IGFib3V0XG4gICAgICB9KVxuICAgIH0pXG4gICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgIGlmKHJlcy5vaykge1xuICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgYWRkTGlrZShjYXJkSUQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVSTH0vbGlrZXMvJHtjYXJkSUR9YCwge1xuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xuICAgIH0pXG4gICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgIGlmKHJlcy5vaykge1xuICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgZGVsZXRlTGlrZShjYXJkSUQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVSTH0vbGlrZXMvJHtjYXJkSUR9YCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xuICAgIH0pXG4gICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgIGlmKHJlcy5vaykge1xuICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgYXZhdGFySW1hZ2UobGluaykge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVVJMfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIGF2YXRhcjogbGlua1xuICAgICAgfSlcbiAgICB9KVxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICBpZihyZXMub2spIHtcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgICB9KTtcbiAgfVxufSIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhDb25maXJtYXRpb24gZXh0ZW5kcyBQb3B1cHtcbiAgY29uc3RydWN0b3Ioe3BvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQsIHN1Ym1pdEJ1dHRvbn0pIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSBzdWJtaXRCdXR0b247XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICBzdXBlci5jbG9zZSgpO1xuICAgIHRoaXMucmVuZGVyTG9hZGluZyhmYWxzZSk7XG4gIH1cblxuICBzZXRTdWJtaXRBY3Rpb24oYWN0aW9uKSB7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGFjdGlvbjtcbiAgfVxuXG4gIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nKSB7XG4gICAgaWYgKGlzTG9hZGluZykge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gJ1NhdmluZy4uLic7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX3N1Ym1pdEJ1dHRvbi5kYXRhc2V0LnRleHRjb250ZW50O1xuICAgIH1cbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLnJlbmRlckxvYWRpbmcodHJ1ZSk7XG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KCk7XG4gICAgfSk7XG4gIH1cbn0iLCJpbXBvcnQgJy4vaW5kZXguY3NzJztcblxuaW1wb3J0IENhcmQgZnJvbSAnLi4vY29tcG9uZW50cy9DYXJkLmpzJztcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gJy4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyc7XG5pbXBvcnQgU2VjdGlvbiBmcm9tICcuLi9jb21wb25lbnRzL1NlY3Rpb24nO1xuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gJy4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UnO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSAnLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtJztcbmltcG9ydCBVc2VySW5mbyBmcm9tICcuLi9jb21wb25lbnRzL1VzZXJJbmZvJztcbmltcG9ydCBBcGkgZnJvbSAnLi4vY29tcG9uZW50cy9BcGknO1xuaW1wb3J0IFBvcHVwV2l0aENvbmZpcm1hdGlvbiBmcm9tICcuLi9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbic7XG5cbi8vR2VuZXJhbFxuY29uc3Qgcm9vdEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucm9vdCcpO1xuY29uc3QgcGFnZUNvbnRhaW5lciA9IHJvb3RFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wYWdlJyk7XG5cbi8vUHJvZmlsZSBjb250YWluZXJcbmV4cG9ydCBjb25zdCBwcm9maWxlQXV0aG9yID0gcGFnZUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYXV0aG9yJyk7XG5leHBvcnQgY29uc3QgcHJvZmlsZUFib3V0ID0gcGFnZUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYWJvdXQtbWUnKTtcbmNvbnN0IHByb2ZpbGVBdmF0YXJDb250YWluZXIgPSBwYWdlQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19jb250YWluZXInKTtcbmNvbnN0IHByb2ZpbGVBdmF0YXIgPSBwYWdlQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJyNwb3B1cF9fYXZhdGFyLWltYWdlJylcblxuLy8gUG9wdXAgcHJvZmlsZVxuY29uc3QgcHJvZmlsZUNvbnRhaW5lciA9IHBhZ2VDb250YWluZXIucXVlcnlTZWxlY3RvcignI3BvcHVwX19wcm9maWxlLWZvcm0nKTtcbmV4cG9ydCBjb25zdCBwb3B1cFByb2ZpbGUgPSBwYWdlQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJyNwb3B1cF9fcHJvZmlsZScpO1xuZXhwb3J0IGNvbnN0IGlucHV0UHJvZmlsZU5hbWUgPSBwcm9maWxlQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJyNuYW1lLWlucHV0Jyk7XG5leHBvcnQgY29uc3QgaW5wdXRQcm9maWxlQWJvdXQgPSBwcm9maWxlQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJyNhYm91dC1pbnB1dCcpO1xuZXhwb3J0IGNvbnN0IGNsb3NlUHJvZmlsZUJ0biA9IHBvcHVwUHJvZmlsZS5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX3Byb2ZpbGUtY2xvc2UtYnRuJyk7XG5leHBvcnQgY29uc3QgZWRpdFByb2ZpbGVCdG4gPSBwYWdlQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19lZGl0LWJ0bicpO1xuZXhwb3J0IGNvbnN0IHN1Ym1pdFByb2ZpbGVCdG4gPSBwb3B1cFByb2ZpbGUucXVlcnlTZWxlY3RvcignLnBvcHVwX19idG4nKTtcblxuLy8gUG9wdXAgcGxhY2VcbmV4cG9ydCBjb25zdCBwbGFjZXNDb250YWluZXIgPSBwYWdlQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJyNwb3B1cF9fcGxhY2VzLWZvcm0nKTtcbmV4cG9ydCBjb25zdCBwb3B1cFBsYWNlcyA9IHBhZ2VDb250YWluZXIucXVlcnlTZWxlY3RvcignI3BvcHVwX19jYXJkcycpO1xuZXhwb3J0IGNvbnN0IGNsb3NlUGxhY2VzQnRuID0gcG9wdXBQbGFjZXMucXVlcnlTZWxlY3RvcignLnBvcHVwX19wbGFjZXMtY2xvc2UtYnRuJyk7XG5leHBvcnQgY29uc3QgYWRkQ2FyZEJ0biA9IHBhZ2VDb250YWluZXIucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2FkZC1idG4nKTtcbmV4cG9ydCBjb25zdCBpbnB1dFBsYWNlTmFtZSA9IHBsYWNlc0NvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX3BsYWNlJyk7XG5leHBvcnQgY29uc3QgaW5wdXRQbGFjZUxpbmsgPSBwbGFjZXNDb250YWluZXIucXVlcnlTZWxlY3RvcignLnBvcHVwX191cmwnKTtcbmNvbnN0IHN1Ym1pdFBsYWNlc0J0biA9IHBsYWNlc0NvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2J0bicpO1xuXG4vLyBQb3B1cCBpbWFnZVxuZXhwb3J0IGNvbnN0IHBvcHVwSW1hZ2UgPSBwYWdlQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJyNpbWFnZS1wb3B1cCcpO1xuXG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fY29udGFpbmVyJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gIGNvbnN0IHBydWViYSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwb3B1cF9fYXZhdGFyLWltYWdlJyk7XG4gIHBydWViYS5jbGFzc0xpc3QuYWRkKCdwb3B1cF9vcGVuZWQnKTtcbn0pXG5cbi8vIEluaXRpYWwgY2FyZHNcbmNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbiAge1xuICAgIG5hbWU6ICdWYWxsZSBkZSBZb3NlbWl0ZScsXG4gICAgbGluazogJ2h0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vbmV3LW1hcmtldHMvV0VCX3NwcmludF81L0VTL3lvc2VtaXRlLmpwZydcbiAgfSxcbiAge1xuICAgIG5hbWU6ICdMYWdvIExvdWlzZScsXG4gICAgbGluazogJ2h0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vbmV3LW1hcmtldHMvV0VCX3NwcmludF81L0VTL2xha2UtbG91aXNlLmpwZydcbiAgfSxcbiAge1xuICAgIG5hbWU6ICdNb250YcOxYXMgQ2FsdmFzJyxcbiAgICBsaW5rOiAnaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9uZXctbWFya2V0cy9XRUJfc3ByaW50XzUvRVMvYmFsZC1tb3VudGFpbnMuanBnJ1xuICB9LFxuICB7XG4gICAgbmFtZTogJ0xhdGVtYXInLFxuICAgIGxpbms6ICdodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL25ldy1tYXJrZXRzL1dFQl9zcHJpbnRfNS9FUy9sYXRlbWFyLmpwZydcbiAgfSxcbiAge1xuICAgIG5hbWU6ICdQYXJxdWUgTmFjaW9uYWwgZGUgbGEgVmFub2lzZScsXG4gICAgbGluazogJ2h0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vbmV3LW1hcmtldHMvV0VCX3NwcmludF81L0VTL3Zhbm9pc2UuanBnJ1xuICB9LFxuICB7XG4gICAgbmFtZTogJ0xhZ28gZGkgQnJhaWVzJyxcbiAgICBsaW5rOiAnaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9uZXctbWFya2V0cy9XRUJfc3ByaW50XzUvRVMvbGFnby5qcGcnXG4gIH1cbl07XG5cbi8vIE51ZXZvIENvZGlnb1xuY29uc3QgcHJvZmlsZUluZm8gPSBuZXcgVXNlckluZm8oe1xuICBuYW1lU2VsZWN0b3I6IHByb2ZpbGVBdXRob3IsXG4gIGFib3V0U2VsZWN0b3I6IHByb2ZpbGVBYm91dCxcbiAgYXZhdGFyU2VsZWN0b3I6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19waG90bycpXG59KTtcblxuY29uc3QgZGVsZXRlQ2FyZCA9IG5ldyBQb3B1cFdpdGhDb25maXJtYXRpb24oe1xuICBwb3B1cFNlbGVjdG9yOiAnI3BvcHVwX19kZWxldGUnLFxuICBzdWJtaXRCdXR0b246IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fY29uZmlybS1idG4nKVxufSk7XG5cbmNvbnN0IGltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoJyNpbWFnZS1wb3B1cCcpO1xuaW1hZ2VQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5kZWxldGVDYXJkLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVVJMOiAnaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS93ZWJfZXNfMDcnLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogJ2I3ZTcxMjg0LTQwMjAtNDRmNC1hODBmLTQzNzIyYzViM2VjZScsXG4gICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICB9XG59KTtcblxuY29uc3QgZWRpdFByb2ZpbGUgPSBuZXcgUG9wdXBXaXRoRm9ybSh7XG4gIHBvcHVwU2VsZWN0b3I6ICcjcG9wdXBfX3Byb2ZpbGUnLFxuICBzdWJtaXRDYWxsYmFjazogKGRhdGEpID0+IHtcbiAgICBhcGlcbiAgICAgIC5lZGl0UHJvZmlsZUluZm8oZGF0YS5uYW1lLCBkYXRhLmFib3V0KVxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICBwcm9maWxlSW5mby5zZXRVc2VySW5mbyh7dXNlcm5hbWU6IHJlcy5uYW1lLCBhYm91dDogcmVzLmFib3V0fSk7XG4gICAgICAgIGVkaXRQcm9maWxlLmNsb3NlKClcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKVxuICB9XG59KTtcbmVkaXRQcm9maWxlLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmFwaS5nZXRVc2VySW5mbygpLnRoZW4oKHJlcykgPT4ge1xuICBwcm9maWxlSW5mby5zZXRVc2VySW5mbyh7dXNlcm5hbWU6IHJlcy5uYW1lLCBhYm91dDogcmVzLmFib3V0fSk7XG4gIC8qcHJvZmlsZUluZm8uc2V0VXNlckF2YXRhcihyZXMuYXZhdGFyKTsqL1xuICBwcm9maWxlSW5mby51c2VySUQgPSByZXMuX2lkO1xufSlcbi50aGVuKCgpID0+IHtcbiAgYXBpLmdldEluaXRpYWxDYXJkcygpLnRoZW4oKHJlcykgPT4ge1xuICAgIGNvbnN0IGNhcmRTZWN0aW9uID0gbmV3IFNlY3Rpb24oe1xuICAgICAgZGF0YTogcmVzLFxuICAgICAgcmVuZGVyZXI6IChkYXRhKSA9PiB7XG4gICAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChkYXRhKTtcbiAgICAgICAgY2FyZFNlY3Rpb24uYWRkSW5pdGFsSXRlbXMoY2FyZEVsZW1lbnQpO1xuICAgICAgICBjb25zb2xlLmxvZyhjYXJkRWxlbWVudCk7XG4gICAgICB9XG4gICAgfSwgJyNlbGVtZW50cycpXG5cbiAgICBjYXJkU2VjdGlvbi5yZW5kZXJlZEl0ZW1zKCk7XG5cbiAgICBjb25zdCBhZGRDYXJkID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xuICAgICAgcG9wdXBTZWxlY3RvcjogXCIjcG9wdXBfX2NhcmRzXCIsXG4gICAgICBzdWJtaXRDYWxsYmFjazogKGRhdGEpID0+IHtcbiAgICAgICAgYXBpXG4gICAgICAgICAgLmFkZE5ld0NhcmQoZGF0YS5uYW1lLCBkYXRhWydwb3B1cF9fbGluayddKVxuICAgICAgICAgIC50aGVuKChjYXJkKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBuZXdDYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoY2FyZCk7XG4gICAgICAgICAgICBjYXJkU2VjdGlvbi5hZGRJdGVtcyhuZXdDYXJkRWxlbWVudCk7XG4gICAgICAgICAgICBhZGRDYXJkLmNsb3NlKCk7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBhZGRDYXJkLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbiAgfSlcbn0pXG5cbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoZGF0YSkge1xuICBjb25zdCBjYXJkRWxlbWVudCA9IG5ldyBDYXJkKGRhdGEgLCAnI2VsZW1lbnQtdGVtcGxhdGUnLCB7XG4gICAgaGFuZGxlQ2FyZENsaWNrOih7bmFtZSwgbGlua30pID0+IHtcbiAgICAgIGltYWdlUG9wdXAub3Blbih7bmFtZSwgbGlua30pXG4gICAgfSxcbiAgICBoYW5kbGVEZWxldGVDbGljazogKHtpZH0pID0+IHtcbiAgICAgIGRlbGV0ZUNhcmQub3BlbigpO1xuICAgICAgZGVsZXRlQ2FyZC5zZXRTdWJtaXRBY3Rpb24oKCkgPT4ge1xuICAgICAgICBhcGkuZGVsZXRlQ2FyZChpZCkudGhlbigoKSA9PiB7XG4gICAgICAgICAgZGVsZXRlQ2FyZC5jbG9zZSgpO1xuICAgICAgICAgIGNhcmRFbGVtZW50Ll9oYW5kbGVUcmFzaEJ0bigpO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XG4gICAgICB9KTtcbiAgICB9LFxuICAgIGhhbmRsZUFkZExpa2U6ICh7aWR9KSA9PiB7XG4gICAgICBhcGkuYWRkTGlrZShpZCkudGhlbigocmVzKSA9PiB7XG4gICAgICAgIGNhcmRFbGVtZW50LnVwZGF0ZUxpa2VzKHJlcy5saWtlcyk7XG4gICAgICAgIGNhcmRFbGVtZW50Ll9oYW5kbGVBZGRMaWtlKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpO1xuICAgIH0sXG4gICAgaGFuZGxlUmVtb3ZlTGlrZTogKHtpZH0pID0+IHtcbiAgICAgIGFwaS5kZWxldGVMaWtlKGlkKS50aGVuKChyZXMpID0+IHtcbiAgICAgICAgY2FyZEVsZW1lbnQudXBkYXRlTGlrZXMocmVzLmxpa2VzKTtcbiAgICAgICAgY2FyZEVsZW1lbnQuX2hhbmRsZVJlbW92ZUxpa2UoKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XG4gICAgfSxcbiAgICB1c2VySUQ6IHByb2ZpbGVJbmZvLnVzZXJJZFxuICB9KTtcbiAgcmV0dXJuIGNhcmRFbGVtZW50LmdlbmVyYXRlQ2FyZCgpO1xufTtcblxuLy8gUmVuZGVyIGluaXRpYWwgY2FyZHNcbi8qY29uc3QgaW5pdGlhbENhcmRMaXN0ID0gbmV3IFNlY3Rpb24oe1xuICBkYXRhOiBpbml0aWFsQ2FyZHMsXG4gIHJlbmRlcmVyOiAoaXRlbSkgPT4ge1xuICAgIGNvbnN0IGRlZmF1bHRDYXJkID0gbmV3IENhcmQoaXRlbSwgJyNlbGVtZW50LXRlbXBsYXRlJywge1xuICAgICAgaGFuZGxlQ2FyZENsaWNrOiAobGluaywgbmFtZSkgPT4ge1xuICAgICAgICBjb25zdCBwb3B1cEltYWdlID0gbmV3IFBvcHVwV2l0aEltYWdlKCcjaW1hZ2UtcG9wdXAnLCBsaW5rLCBuYW1lKTtcbiAgICAgICAgcG9wdXBJbWFnZS5vcGVuKCk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgY29uc3QgZGVmYXVsdEVsZW1lbnRDYXJkID0gZGVmYXVsdENhcmQuZ2VuZXJhdGVDYXJkKCk7XG4gICAgaW5pdGlhbENhcmRMaXN0LmFkZEluaXRhbEl0ZW1zKGRlZmF1bHRFbGVtZW50Q2FyZCk7XG4gIH1cbn0sICcjZWxlbWVudHMnKTtcblxuaW5pdGlhbENhcmRMaXN0LnJlbmRlcmVkSXRlbXMoKTtcblxuLy8gQ3JlYXRlIG5ldyBjYXJkc1xuZnVuY3Rpb24gY3JlYXRlQ2FyZHMoaXRlbSkge1xuICBjb25zdCBjYXJkID0gbmV3IENhcmQoaXRlbSwgJyNlbGVtZW50LXRlbXBsYXRlJywge1xuICAgIGhhbmRsZUNhcmRDbGljazogKGxpbmssIG5hbWUpID0+IHtcbiAgICAgIGNvbnN0IGltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoJyNpbWFnZS1wb3B1cCcsIGxpbmssIG5hbWUpO1xuICAgICAgaW1hZ2VQb3B1cC5vcGVuKCk7XG4gICAgfSxcbiAgfSk7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZC5nZW5lcmF0ZUNhcmQoKTtcbiAgaW5pdGlhbENhcmRMaXN0LmFkZEl0ZW1zKGNhcmRFbGVtZW50KTtcbn1cblxuY29uc3QgY2FyZHNGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xuICBwb3B1cFNlbGVjdG9yOiAnI3BvcHVwX19jYXJkcycsXG4gIHN1Ym1pdENhbGxiYWNrOiAoaXRlbSkgPT4ge1xuICAgIGNyZWF0ZUNhcmRzKGl0ZW0pO1xuICAgIGNhcmRzRm9ybS5jbG9zZSgpO1xuICB9XG59KTtcblxuY2FyZHNGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbi8vIENoYW5nZSB1c2VyIGluZm9ybWF0aW9uXG4vKmNvbnN0IHVzZXJJbmZvUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybSh7XG4gIHBvcHVwU2VsZWN0b3I6ICcjcG9wdXBfX3Byb2ZpbGUnLFxuICBzdWJtaXRDYWxsYmFjazogKCkgPT4ge1xuICAgIGNvbnN0IHNldEluZm8gPSBuZXcgVXNlckluZm8oe1xuICAgICAgbmFtZVNlbGVjdG9yOiBwcm9maWxlQXV0aG9yLFxuICAgICAgYWJvdXRTZWxlY3RvcjogcHJvZmlsZUFib3V0XG4gICAgfSlcbiAgICBzZXRJbmZvLnNldFVzZXJJbmZvKCk7XG4gIH1cbn0pO1xuXG51c2VySW5mb1BvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7Ki9cblxuY29uc3QgdG9nZ2xlQWRkQ2FyZHNQb3B1cCA9ICgpID0+IHtcbiAgcG9wdXBQbGFjZXMuY2xhc3NMaXN0LnRvZ2dsZSgncG9wdXBfb3BlbmVkJyk7XG59XG5cbmFkZENhcmRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0b2dnbGVBZGRDYXJkc1BvcHVwKTtcblxuY29uc3Qgb3BlblByb2ZpbGVQb3B1cCA9ICgpID0+IHtcbiAgcG9wdXBQcm9maWxlLmNsYXNzTGlzdC5hZGQoJ3BvcHVwX29wZW5lZCcpO1xuICBzdWJtaXRQcm9maWxlQnRuLmNsYXNzTGlzdC5hZGQoJ3BvcHVwX19idG5faW5hY3RpdmUnKTtcbn1cblxuZWRpdFByb2ZpbGVCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvcGVuUHJvZmlsZVBvcHVwKTtcblxuLypleHBvcnQgZnVuY3Rpb24gY3JlYXRlTmV3Q2FyZChjYXJkKSB7XG4gIGNvbnN0IG5ld0NhcmQgPSBuZXcgQ2FyZChjYXJkLCAnI2VsZW1lbnQtdGVtcGxhdGUnKTtcbiAgY29uc3QgbmV3Q2FyZEVsZW1lbnQgPSBuZXdDYXJkLmdlbmVyYXRlQ2FyZCgpO1xuXG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNlbGVtZW50cycpLnByZXBlbmQobmV3Q2FyZEVsZW1lbnQpO1xufSovXG5cbi8vIElucHV0IHZhbGlkYXRpb25zXG5jb25zdCB2YWxpZGF0aW9uID0gbmV3IEZvcm1WYWxpZGF0b3IoZG9jdW1lbnQpO1xuXG5cbnZhbGlkYXRpb24uZW5hYmxlVmFsaWRhdGlvbigpOyJdLCJuYW1lcyI6WyJDYXJkIiwiZGF0YSIsImNhcmRTZWxlY3RvciIsIl9yZWYiLCJfdGhpcyIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZURlbGV0ZUNsaWNrIiwiaGFuZGxlQWRkTGlrZSIsImhhbmRsZVJlbW92ZUxpa2UiLCJ1c2VySUQiLCJfY2xhc3NDYWxsQ2hlY2siLCJyZXNBcnJheSIsIl9saWtlc0FycmF5IiwidGhpcyIsIl9uYW1lIiwibmFtZSIsIl9saW5rIiwibGluayIsIl9pZCIsImlkIiwibGlrZXMiLCJfY2FyZExpa2VzIiwibGVuZ3RoIiwiX293bmVySWQiLCJvd25lciIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlQ2FyZENsaWNrIiwiX2hhbmRsZURlbGV0ZUNsaWNrIiwiX2hhbmRsZUFkZExpa2UiLCJfaGFuZGxlUmVtb3ZlTGlrZSIsIl91c2VyIiwiX2hlYXJ0QnV0dG9uIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiX2hlYXJ0TnVtYmVyIiwia2V5IiwidmFsdWUiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX3RoaXMyIiwiX2VsZW1lbnQiLCJfZ2V0VGVtcGxhdGUiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJ0ZXh0Q29udGVudCIsInNyYyIsImFsdCIsImNvbmNhdCIsImhhc1VzZXJMaWtlZCIsInNvbWUiLCJsaWtlIiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwiX3RoaXMzIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9oYW5kbGVUcmFzaEJ0biIsIl9oYW5kbGVPcGVuSW1hZ2VQb3B1cCIsImFkZCIsInJlbW92ZSIsIkZvcm1WYWxpZGF0b3IiLCJfY3JlYXRlQ2xhc3MiLCJ2YWxpZGF0aW9uIiwiX2RlZmluZVByb3BlcnR5IiwiZm9ybUVsZW1lbnQiLCJpbnB1dEVsZW1lbnQiLCJlcnJvck1lc3NhZ2UiLCJlcnJvckVsZW1lbnQiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hpZGVJbnB1dEVycm9yIiwiX3Nob3dJbnB1dEVycm9yIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJpbnB1dExpc3QiLCJidXR0b25FbGVtZW50IiwiX2hhc0ludmFsaWRJbnB1dCIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJmb3JFYWNoIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsImV2dCIsInByZXZlbnREZWZhdWx0IiwiZmllbGRzZXQiLCJfdmFsaWRhdGlvbiIsIlNlY3Rpb24iLCJjb250YWluZXJTZWxlY3RvciIsInJlbmRlcmVyIiwiX2RhdGFBcnJheSIsIl9jb250YWluZXIiLCJpdGVtIiwiZWxlbWVudCIsImFwcGVuZCIsInByZXBlbmQiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXBFbGVtZW50IiwiX2hhbmRsZUVzY0Nsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImNsb3NlIiwidGFyZ2V0IiwiY29udGFpbnMiLCJfaGFuZGxlT3V0c2lkZUNsaWNrIiwiUG9wdXBXaXRoSW1hZ2UiLCJfUG9wdXAiLCJfaW5oZXJpdHMiLCJfc3VwZXIiLCJjYWxsIiwiX3BvcHVwSW1hZ2UiLCJfcG9wdXBUaXRsZSIsIl9nZXQiLCJfZ2V0UHJvdG90eXBlT2YiLCJwcm90b3R5cGUiLCJQb3B1cFdpdGhGb3JtIiwic3VibWl0Q2FsbGJhY2siLCJfZm9ybSIsIl9idXR0b25TdWJtaXQiLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9pbnB1dExpc3QiLCJmb3JtVmFsdWVzIiwiaW5wdXQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJyZXNldCIsIlVzZXJJbmZvIiwibmFtZVNlbGVjdG9yIiwiYWJvdXRTZWxlY3RvciIsImF2YXRhclNlbGVjdG9yIiwiX3VzZXJuYW1lIiwiX2Fib3V0IiwiX2F2YXRhclNlbGVjdG9yIiwiX3VzZXJJRCIsIl9uYW1lSW5wdXQiLCJfYWJvdXRJbnB1dCIsImFib3V0IiwiX2pvYklucHV0IiwidXNlcm5hbWUiLCJhdmF0YXIiLCJBcGkiLCJiYXNlVVJMIiwiaGVhZGVycyIsIl9iYXNlVVJMIiwiX2hlYWRlcnMiLCJmZXRjaCIsIm1ldGhvZCIsInRoZW4iLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJjYXJkSUQiLCJQb3B1cFdpdGhDb25maXJtYXRpb24iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VibWl0QnV0dG9uIiwiX3N1Ym1pdEJ1dHRvbiIsInJlbmRlckxvYWRpbmciLCJhY3Rpb24iLCJpc0xvYWRpbmciLCJkYXRhc2V0IiwidGV4dGNvbnRlbnQiLCJwYWdlQ29udGFpbmVyIiwicHJvZmlsZUF1dGhvciIsInByb2ZpbGVBYm91dCIsInByb2ZpbGVDb250YWluZXIiLCJwb3B1cFByb2ZpbGUiLCJlZGl0UHJvZmlsZUJ0biIsInN1Ym1pdFByb2ZpbGVCdG4iLCJwbGFjZXNDb250YWluZXIiLCJwb3B1cFBsYWNlcyIsImFkZENhcmRCdG4iLCJwcm9maWxlSW5mbyIsImRlbGV0ZUNhcmQiLCJpbWFnZVBvcHVwIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJhcGkiLCJhdXRob3JpemF0aW9uIiwiZWRpdFByb2ZpbGUiLCJlZGl0UHJvZmlsZUluZm8iLCJzZXRVc2VySW5mbyIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImxvZyIsImNyZWF0ZUNhcmQiLCJjYXJkRWxlbWVudCIsIm9wZW4iLCJfcmVmMiIsInNldFN1Ym1pdEFjdGlvbiIsIl9yZWYzIiwiYWRkTGlrZSIsInVwZGF0ZUxpa2VzIiwiX3JlZjQiLCJkZWxldGVMaWtlIiwidXNlcklkIiwiZ2VuZXJhdGVDYXJkIiwiZ2V0VXNlckluZm8iLCJnZXRJbml0aWFsQ2FyZHMiLCJjYXJkU2VjdGlvbiIsImFkZEluaXRhbEl0ZW1zIiwicmVuZGVyZWRJdGVtcyIsImFkZENhcmQiLCJhZGROZXdDYXJkIiwiY2FyZCIsIm5ld0NhcmRFbGVtZW50IiwiYWRkSXRlbXMiLCJlbmFibGVWYWxpZGF0aW9uIl0sInNvdXJjZVJvb3QiOiIifQ==