!function(){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,n(o.key),o)}}function n(t){var n=function(t,n){if("object"!==e(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,"string");if("object"!==e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===e(n)?n:String(n)}var r=function(){function e(t,r,o){var i,u,c,a=this,l=o.handleCardClick,s=o.handleDeleteClick,f=o.handleAddLike,p=o.handleRemoveLike,y=o.userID;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i=this,c=function(e){return a._likesArray=e,a._likesArray},(u=n(u="updateLikes"))in i?Object.defineProperty(i,u,{value:c,enumerable:!0,configurable:!0,writable:!0}):i[u]=c,this._name=t.name,this._link=t.link,this._id=t._id,this._likesArray=t.likes,this._cardLikes=this._likesArray.length,this._ownerId=t.owner._id,this._cardSelector=r,this._handleCardClick=l,this._handleDeleteClick=s,this._handleAddLike=f,this._handleRemoveLike=p,this._user=y}var r,o;return r=e,(o=[{key:"_getTemplate",value:function(){return document.querySelector(this._cardSelector).content.querySelector(".element").cloneNode(!0)}},{key:"generateCard",value:function(){var e=this;this._element=this._getTemplate(),this._setEventListeners(),this._element.querySelector(".element__name").textContent=this._name,this._element.querySelector(".element__image").src=this._link,this._element.querySelector(".element__image").alt="Imagen de ".concat(this._name),this._element.querySelector(".element__like-counter").textContent=this._cardLikes?this._cardLikes:"";var t=this._likesArray.some((function(t){t._id,e._user}));return this._element.querySelector(".element__heart").classList.toggle("element__heart_black",t),this._element}},{key:"_setEventListeners",value:function(){var e=this;this._element.querySelector(".element__heart").addEventListener("click",(function(){e._likesArray.some((function(t){t._id,e._user,console.log("Like.id: ".concat(t._id)),console.log("_userID: ".concat(e._user))}))?e._handleRemoveLike({id:e._id}):e._handleAddLike({id:e._id})})),this._element.querySelector(".element__image").addEventListener("click",(function(){e._openImagePopup()})),this._element.querySelector(".element__trash").addEventListener("click",(function(){e._handleDeleteClick({id:e._id})})),this._ownerId!==this._user&&this._element.querySelector(".element__trash").remove()}},{key:"addLikeFilter",value:function(){this._element.querySelector(".element__heart").classList.add("element__heart_black"),this._element.querySelector(".element__like-counter").textContent=this._likesArray.length}},{key:"_removeLike",value:function(){this._element.querySelector(".element__heart").classList.remove("element__heart_black"),this._element.querySelector(".element__like-counter").textContent=this._likesArray.length,"0"===this._cardLikes&&(this._element.querySelector(".element__like-counter").textContent="")}},{key:"_trashBtn",value:function(){this._element.querySelector(".element__trash").closest(".element").remove()}},{key:"_openImagePopup",value:function(){this._handleCardClick({link:this._link,name:this._name})}}])&&t(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),e}();function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a(r.key),r)}}function u(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function c(e,t,n){return(t=a(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e){var t=function(e,t){if("object"!==o(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===o(t)?t:String(t)}var l=u((function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),c(this,"_showInputError",(function(e,t,n){var r=e.querySelector(".".concat(t.id,"-error"));t.classList.add("form__input_type_error"),r.textContent=n,r.classList.add("form__input-error_active")})),c(this,"_hideInputError",(function(e,t){var n=e.querySelector(".".concat(t.id,"-error"));t.classList.remove("form__input_type_error"),n.classList.remove("form__input-error_active"),n.textContent=""})),c(this,"_checkInputValidity",(function(e,t){t.validity.valid?n._hideInputError(e,t):n._showInputError(e,t,t.validationMessage)})),c(this,"_hasInvalidInput",(function(e){return e.some((function(e){return!e.validity.valid}))})),c(this,"_toggleButtonState",(function(e,t){n._hasInvalidInput(e)?t.classList.add("popup__btn_inactive"):t.classList.remove("popup__btn_inactive")})),c(this,"_setEventListeners",(function(e){var t=Array.from(e.querySelectorAll(".form__input")),r=e.querySelector(".popup__btn");n._toggleButtonState(t,r),t.forEach((function(o){o.addEventListener("input",(function(){n._checkInputValidity(e,o),n._toggleButtonState(t,r)}))}))})),c(this,"enableValidation",(function(){Array.from(document.querySelectorAll(".form")).forEach((function(e){var t=e.querySelector(".popup__btn");e.addEventListener("submit",(function(e){t.classList.add("popup__btn_inactive"),e.preventDefault()})),Array.from(e.querySelectorAll(".form__set")).forEach((function(e){n._setEventListeners(e)}))}))})),this._validation=t}));function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==s(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===s(o)?o:String(o)),r)}var o}var p=function(){function e(t,n){var r=t.data,o=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._dataArray=r,this.renderer=o,this._container=document.querySelector(n)}var t,n;return t=e,(n=[{key:"renderedItems",value:function(){var e=this;this._dataArray.forEach((function(t){e.renderer(t)}))}},{key:"addInitalItems",value:function(e){this._container.append(e)}},{key:"addItems",value:function(e){this._container.prepend(e)}}])&&f(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==y(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===y(o)?o:String(o)),r)}var o}var d=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._popupElement=document.querySelector(t)}var t,n;return t=e,(n=[{key:"open",value:function(){this._popupElement.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}},{key:"close",value:function(){this._popupElement.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}},{key:"_handleEscClose",value:function(e){if("Escape"===e.key)return this.close()}},{key:"_handleOutsideClick",value:function(e){(e.target.classList.contains("popup__section")||e.target.classList.contains("popup__background"))&&this.close()}},{key:"setEventListeners",value:function(){var e=this;this._popupElement.querySelector(".popup__close-btn").addEventListener("click",(function(){e.close()})),document.addEventListener("keydown",(function(t){e._handleEscClose(t)})),this._popupElement.addEventListener("click",(function(t){e._handleOutsideClick(t)}))}}])&&m(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==h(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==h(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===h(o)?o:String(o)),r)}var o}function b(){return b="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=S(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},b.apply(this,arguments)}function v(e,t){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},v(e,t)}function S(e){return S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},S(e)}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=S(r);if(o){var n=S(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===h(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=i.call(this,e))._popupImage=t._popupElement.querySelector(".image-popup__image"),t._popupTitle=t._popupElement.querySelector(".image-popup__title"),t}return t=u,(n=[{key:"open",value:function(e){var t=e.link,n=e.name;b(S(u.prototype),"open",this).call(this),this._popupImage.src=t,this._popupImage.alt="Imagen de ".concat(n),this._popupTitle.textContent=n,b(S(u.prototype),"setEventListeners",this).call(this)}}])&&_(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(d);function k(e){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},k(e)}function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==k(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==k(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===k(o)?o:String(o)),r)}var o}function E(){return E="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=j(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},E.apply(this,arguments)}function L(e,t){return L=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},L(e,t)}function j(e){return j=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},j(e)}var P=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&L(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=j(r);if(o){var n=j(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===k(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function u(e){var t,n=e.popupSelector,r=e.submitCallback;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=i.call(this,n))._form=t._popupElement.querySelector(".form"),t._buttonSubmit=t._popupElement.querySelector(".popup__btn"),t._handleFormSubmit=r,t}return t=u,(n=[{key:"_getInputValues",value:function(){var e=this;return this._inputList=this._form.querySelectorAll(".form__input"),this.formValues={},this._inputList.forEach((function(t){e.formValues[t.name]=t.value})),this.formValues}},{key:"setEventListeners",value:function(){var e=this;E(j(u.prototype),"setEventListeners",this).call(this),this._form.addEventListener("submit",(function(t){t.preventDefault(),e._handleFormSubmit(e._getInputValues()),e.close()}))}},{key:"close",value:function(){E(j(u.prototype),"close",this).call(this),this._form.reset(),this._popupElement.querySelector(".popup__btn").classList.add("popup__btn_inactive")}}])&&w(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(d);function O(e){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},O(e)}function q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==O(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==O(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===O(o)?o:String(o)),r)}var o}var C=function(){function e(t){var n=t.nameSelector,r=t.aboutSelector,o=t.avatarSelector,i=t.userID;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._username=n,this._about=r,this._avatarSelector=o,this._userID=i,this._nameInput=document.querySelector("#name-input"),this._aboutInput=document.querySelector("#about-input")}var t,n;return t=e,(n=[{key:"getUserInfo",value:function(){return{name:this._nameInput.textContent,about:this._jobInput.textContent}}},{key:"setUserInfo",value:function(e){var t=e.username,n=e.about;this._username.textContent=t,this._about.textContent=n}},{key:"setUserAvatar",value:function(e){this._avatarSelector.src=e}}])&&q(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function I(e){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I(e)}function R(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==I(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==I(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===I(o)?o:String(o)),r)}var o}var T=function(){function e(t){var n=t.baseURL,r=t.headers;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._baseURL=n,this._headers=r}var t,n;return t=e,(n=[{key:"getInitialCards",value:function(){return fetch("".concat(this._baseURL,"/cards"),{method:"GET",headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"addNewCard",value:function(e,t){return fetch("".concat(this._baseURL,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"deleteCard",value:function(e){return fetch("".concat(this._baseURL,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"getUserInfo",value:function(){return fetch("".concat(this._baseURL,"/users/me"),{method:"GET",headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"editProfileInfo",value:function(e,t){return fetch("".concat(this._baseURL,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"addLike",value:function(e){return fetch("".concat(this._baseURL,"/cards/likes/").concat(e),{method:"PUT",headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"deleteLike",value:function(e){return fetch("".concat(this._baseURL,"/cards/likes/").concat(e),{method:"DELETE",headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"avatarImage",value:function(e){return fetch("".concat(this._baseURL,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}}])&&R(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function A(e){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},A(e)}function D(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==A(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==A(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===A(o)?o:String(o)),r)}var o}function x(){return x="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=U(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},x.apply(this,arguments)}function B(e,t){return B=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},B(e,t)}function U(e){return U=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},U(e)}var V=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&B(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=U(r);if(o){var n=U(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===A(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function u(e){var t,n=e.popupSelector,r=e.handleFormSubmit,o=e.submitButton;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=i.call(this,n))._handleFormSubmit=r,t._submitButton=o,t}return t=u,(n=[{key:"close",value:function(){x(U(u.prototype),"close",this).call(this),this.renderLoading(!1)}},{key:"setSubmitAction",value:function(e){this._handleFormSubmit=e}},{key:"renderLoading",value:function(e){e?(this._submitButton.textContent="Guardando...",this._submitButton.classList.add("popup__btn_inactive")):(this._submitButton.textContent="Sí",this._submitButton.classList.remove("popup__btn_inactive"))}},{key:"setEventListeners",value:function(){var e=this;x(U(u.prototype),"setEventListeners",this).call(this),this._submitButton.addEventListener("click",(function(t){t.preventDefault(),e._handleFormSubmit(),e.renderLoading(!0)}))}}])&&D(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(d),F=document.querySelector(".root").querySelector(".page"),N=F.querySelector(".profile__author"),G=F.querySelector(".profile__about-me"),J=(F.querySelector(".profile__container"),F.querySelector("#popup__avatar-image"),F.querySelector("#popup__profile-form")),H=F.querySelector("#popup__profile"),z=(J.querySelector("#name-input"),J.querySelector("#about-input"),H.querySelector(".popup__profile-close-btn"),F.querySelector(".profile__edit-btn")),M=H.querySelector(".popup__btn"),K=F.querySelector("#popup__places-form"),Q=F.querySelector("#popup__cards"),W=(Q.querySelector(".popup__places-close-btn"),F.querySelector(".profile__add-btn"));K.querySelector(".popup__place"),K.querySelector(".popup__url"),K.querySelector(".popup__btn"),F.querySelector("#image-popup"),document.querySelector(".profile__container").addEventListener("click",(function(){document.querySelector("#popup__avatar-image").classList.add("popup_opened")}));var X=new C({nameSelector:N,aboutSelector:G,avatarSelector:document.querySelector(".profile__photo")}),Y=new V({popupSelector:"#popup__delete",submitButton:document.querySelector(".popup__confirm-btn")}),Z=new g("#image-popup");Z.setEventListeners(),Y.setEventListeners();var $=new T({baseURL:"https://around.nomoreparties.co/v1/web_es_07",headers:{authorization:"b7e71284-4020-44f4-a80f-43722c5b3ece","Content-Type":"application/json"}}),ee=new P({popupSelector:"#popup__profile",submitCallback:function(e){$.editProfileInfo(e.name,e.about).then((function(e){X.setUserInfo({username:e.name,about:e.about}),ee.close()})).catch((function(e){return console.log(e)}))}});function te(e){var t=new r(e,"#element-template",{handleCardClick:function(e){var t=e.name,n=e.link;Z.open({name:t,link:n})},handleDeleteClick:function(e){var n=e.id;Y.open(),Y.setSubmitAction((function(){$.deleteCard(n).then((function(){Y.close(),t._trashBtn()})).catch((function(e){return console.log(e)}))}))},handleAddLike:function(e){var n=e.id;$.addLike(n).then((function(e){t.updateLikes(e.likes),t.addLikeFilter()})).catch((function(e){return console.log(e)}))},handleRemoveLike:function(e){var n=e.id;$.deleteLike(n).then((function(e){t.updateLikes(e.likes),t._removeLike()})).catch((function(e){return console.log(e)}))},userID:X.userID});return t.generateCard()}ee.setEventListeners(),$.getUserInfo().then((function(e){X.setUserInfo({username:e.name,about:e.about}),X.userID=e._id})).then((function(){$.getInitialCards().then((function(e){var t=new p({data:e,renderer:function(e){var n=te(e);t.addInitalItems(n)}},"#elements");t.renderedItems();var n=new P({popupSelector:"#popup__cards",submitCallback:function(e){$.addNewCard(e.name,e.link).then((function(e){var r=te(e);t.addItems(r),n.close()})).catch((function(e){return console.log(e)}))}});n.setEventListeners()}))})),W.addEventListener("click",(function(){Q.classList.toggle("popup_opened")})),z.addEventListener("click",(function(){H.classList.add("popup_opened"),M.classList.add("popup__btn_inactive")})),new l(document).enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUFBWWxLLFNBRXRCLE9BQU84SyxFQUFRYSxjQUNqQixDQXRFQW5CLEdBQVlILG9CQUVaQyxFQUFJc0IsY0FBY3RELE1BQUssU0FBQ0MsR0FDdEIyQixFQUFZUSxZQUFZLENBQUM3QyxTQUFVVSxFQUFJakksS0FBTXFILE1BQU9ZLEVBQUlaLFFBRXhEdUMsRUFBWWxLLE9BQVN1SSxFQUFJOUgsR0FDM0IsSUFDQzZILE1BQUssV0FDSmdDLEVBQUl1QixrQkFBa0J2RCxNQUFLLFNBQUNDLEdBQzFCLElBQU11RCxFQUFjLElBQUluSCxFQUFRLENBQzlCbkYsS0FBTStJLEVBQ04xRCxTQUFVLFNBQUNyRixHQUNULElBQU11TSxFQUFjbEIsR0FBV3JMLEdBQy9Cc00sRUFBWUUsZUFBZUQsRUFDN0IsR0FDQyxhQUVIRCxFQUFZRyxnQkFFWixJQUFNQyxFQUFVLElBQUkzRixFQUFjLENBQ2hDbEIsY0FBZSxnQkFDZm1CLGVBQWdCLFNBQUNoSCxHQUNmOEssRUFDRzZCLFdBQVczTSxFQUFLYyxLQUFNZCxFQUFLZ0IsTUFDM0I4SCxNQUFLLFNBQUM4RCxHQUNMLElBQU1DLEVBQWlCeEIsR0FBV3VCLEdBQ2xDTixFQUFZUSxTQUFTRCxHQUNyQkgsRUFBUXpHLE9BQ1YsSUFDQ2tGLE9BQU0sU0FBQ0MsR0FBRyxPQUFLbEksUUFBUUMsSUFBSWlJLEVBQUksR0FDcEMsSUFHRnNCLEVBQVE3QixtQkFFVixHQUNGLElBNkZBSixFQUFXeEgsaUJBQWlCLFNBSkEsV0FDMUJ1SCxFQUFZMUgsVUFBVUMsT0FBTyxlQUMvQixJQVNBc0gsRUFBZXBILGlCQUFpQixTQUxQLFdBQ3ZCbUgsRUFBYXRILFVBQVVTLElBQUksZ0JBQzNCK0csRUFBaUJ4SCxVQUFVUyxJQUFJLHNCQUNqQyxJQVltQixJQUFJRSxFQUFjMUIsVUFDMUJnTCxrQiIsInNvdXJjZXMiOlsid2VicGFjazovL3dlYl9wcm9qZWN0XzRfZXNwLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80X2VzcC8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNF9lc3AvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzRfZXNwLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNF9lc3AvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80X2VzcC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNF9lc3AvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80X2VzcC8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80X2VzcC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80X2VzcC8uL3NyYy9wYWdlL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihkYXRhLCBjYXJkU2VsZWN0b3IsIHsgaGFuZGxlQ2FyZENsaWNrLCBoYW5kbGVEZWxldGVDbGljaywgaGFuZGxlQWRkTGlrZSwgaGFuZGxlUmVtb3ZlTGlrZSwgdXNlcklEIH0pIHtcbiAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xuICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XG4gICAgdGhpcy5faWQgPSBkYXRhLl9pZDtcbiAgICB0aGlzLl9saWtlc0FycmF5ID0gZGF0YS5saWtlcztcbiAgICB0aGlzLl9jYXJkTGlrZXMgPSB0aGlzLl9saWtlc0FycmF5Lmxlbmd0aDtcbiAgICB0aGlzLl9vd25lcklkID0gZGF0YS5vd25lci5faWQ7XG5cbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XG5cbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sgPSBoYW5kbGVEZWxldGVDbGljaztcbiAgICB0aGlzLl9oYW5kbGVBZGRMaWtlID0gaGFuZGxlQWRkTGlrZTtcbiAgICB0aGlzLl9oYW5kbGVSZW1vdmVMaWtlID0gaGFuZGxlUmVtb3ZlTGlrZTtcblxuICAgIHRoaXMuX3VzZXIgPSB1c2VySUQ7XG4gIH1cblxuICBfZ2V0VGVtcGxhdGUoKSB7XG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxuICAgICAgLmNvbnRlbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudCcpXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xuXG4gICAgcmV0dXJuIGNhcmRFbGVtZW50O1xuICB9XG5cbiAgZ2VuZXJhdGVDYXJkKCkge1xuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG5cbiAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50X19uYW1lJykudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xuICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmVsZW1lbnRfX2ltYWdlJykuc3JjID0gdGhpcy5fbGluaztcbiAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50X19pbWFnZScpLmFsdCA9IGBJbWFnZW4gZGUgJHt0aGlzLl9uYW1lfWA7XG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudF9fbGlrZS1jb3VudGVyJykudGV4dENvbnRlbnQgPSB0aGlzLl9jYXJkTGlrZXMgPyB0aGlzLl9jYXJkTGlrZXMgOiAnJztcblxuICAgIGNvbnN0IGhhc1VzZXJMaWtlZCA9IHRoaXMuX2xpa2VzQXJyYXkuc29tZSgobGlrZSkgPT4ge1xuICAgICAgbGlrZS5faWQgPT09IHRoaXMuX3VzZXJcbiAgICB9KTtcblxuICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmVsZW1lbnRfX2hlYXJ0JykuY2xhc3NMaXN0LnRvZ2dsZSgnZWxlbWVudF9faGVhcnRfYmxhY2snLCBoYXNVc2VyTGlrZWQpO1xuXG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudF9faGVhcnQnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcblxuICAgICAgY29uc3QgaGFzVXNlckxpa2VkID0gdGhpcy5fbGlrZXNBcnJheS5zb21lKChsaWtlKSA9PiB7XG4gICAgICAgIGxpa2UuX2lkID09PSB0aGlzLl91c2VyXG4gICAgICAgIGNvbnNvbGUubG9nKGBMaWtlLmlkOiAke2xpa2UuX2lkfWApO1xuICAgICAgICBjb25zb2xlLmxvZyhgX3VzZXJJRDogJHt0aGlzLl91c2VyfWApO1xuICAgICAgfSk7XG5cbiAgICAgIGlmIChoYXNVc2VyTGlrZWQpIHtcbiAgICAgICAgdGhpcy5faGFuZGxlUmVtb3ZlTGlrZSh7aWQ6IHRoaXMuX2lkfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLl9oYW5kbGVBZGRMaWtlKHtpZDogdGhpcy5faWR9KTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmVsZW1lbnRfX2ltYWdlJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLl9vcGVuSW1hZ2VQb3B1cCgpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudF9fdHJhc2gnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrKHtpZDogdGhpcy5faWR9KTtcbiAgICB9KTtcblxuICAgIGlmICh0aGlzLl9vd25lcklkICE9PSB0aGlzLl91c2VyKSB7XG4gICAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50X190cmFzaCcpLnJlbW92ZSgpO1xuICAgIH1cbiAgfVxuXG4gIGFkZExpa2VGaWx0ZXIoKSB7XG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudF9faGVhcnQnKS5jbGFzc0xpc3QuYWRkKCdlbGVtZW50X19oZWFydF9ibGFjaycpO1xuICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmVsZW1lbnRfX2xpa2UtY291bnRlcicpLnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXNBcnJheS5sZW5ndGg7XG4gIH1cblxuICBfcmVtb3ZlTGlrZSgpIHtcbiAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50X19oZWFydCcpLmNsYXNzTGlzdC5yZW1vdmUoJ2VsZW1lbnRfX2hlYXJ0X2JsYWNrJyk7XG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudF9fbGlrZS1jb3VudGVyJykudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlc0FycmF5Lmxlbmd0aDtcbiAgICBpZih0aGlzLl9jYXJkTGlrZXMgPT09ICcwJykge1xuICAgICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudF9fbGlrZS1jb3VudGVyJykudGV4dENvbnRlbnQgPSAnJztcbiAgICB9XG4gIH1cblxuICB1cGRhdGVMaWtlcyA9IChyZXNBcnJheSkgPT4ge1xuICAgIHRoaXMuX2xpa2VzQXJyYXkgPSByZXNBcnJheTtcbiAgICByZXR1cm4gdGhpcy5fbGlrZXNBcnJheTtcbiAgfTtcblxuICBfdHJhc2hCdG4oKSB7XG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudF9fdHJhc2gnKS5jbG9zZXN0KCcuZWxlbWVudCcpLnJlbW92ZSgpO1xuICB9XG5cbiAgX29wZW5JbWFnZVBvcHVwKCkge1xuICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayh7bGluazogdGhpcy5fbGluaywgbmFtZTogdGhpcy5fbmFtZX0pO1xuICB9XG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKHZhbGlkYXRpb24pIHtcbiAgICB0aGlzLl92YWxpZGF0aW9uID0gdmFsaWRhdGlvbjtcbiAgfVxuXG4gIF9zaG93SW5wdXRFcnJvciA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UpID0+IHtcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2Zvcm1fX2lucHV0X3R5cGVfZXJyb3InKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2Zvcm1fX2lucHV0LWVycm9yX2FjdGl2ZScpO1xuICB9O1xuXG4gIF9oaWRlSW5wdXRFcnJvciA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdmb3JtX19pbnB1dF90eXBlX2Vycm9yJyk7XG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2Zvcm1fX2lucHV0LWVycm9yX2FjdGl2ZScpO1xuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9ICcnO1xuICB9O1xuXG4gIF9jaGVja0lucHV0VmFsaWRpdHkgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCkgPT4ge1xuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50KTtcbiAgICB9XG4gIH07XG5cbiAgX2hhc0ludmFsaWRJbnB1dCA9IChpbnB1dExpc3QpID0+IHtcbiAgICByZXR1cm4gaW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgcmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XG4gICAgfSk7XG4gIH07XG5cbiAgX3RvZ2dsZUJ1dHRvblN0YXRlID0gKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCkgPT4ge1xuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSkge1xuICAgICAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdwb3B1cF9fYnRuX2luYWN0aXZlJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgncG9wdXBfX2J0bl9pbmFjdGl2ZScpO1xuICAgIH1cbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycyA9IChmb3JtRWxlbWVudCkgPT4ge1xuICAgIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmZvcm1fX2lucHV0JykpO1xuICAgIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2J0bicpO1xuXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50KTtcblxuICAgIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQpO1xuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBlbmFibGVWYWxpZGF0aW9uID0gKCkgPT4ge1xuICAgIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZm9ybScpKTtcblxuICAgIGZvcm1MaXN0LmZvckVhY2goKGZvcm1FbGVtZW50KSA9PiB7XG4gICAgICBjb25zdCBidXR0b25FbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19idG4nKTtcbiAgICAgIGZvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGZ1bmN0aW9uIChldnQpIHtcbiAgICAgICAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdwb3B1cF9fYnRuX2luYWN0aXZlJyk7XG4gICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IGZpZWxkc2V0TGlzdCA9IEFycmF5LmZyb20oZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmZvcm1fX3NldCcpKTtcblxuICAgICAgZmllbGRzZXRMaXN0LmZvckVhY2goKGZpZWxkc2V0KSA9PiB7XG4gICAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKGZpZWxkc2V0KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHsgZGF0YSwgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9kYXRhQXJyYXkgPSBkYXRhO1xuICAgIHRoaXMucmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcbiAgfVxuXG4gIHJlbmRlcmVkSXRlbXMoKSB7XG4gICAgdGhpcy5fZGF0YUFycmF5LmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgIHRoaXMucmVuZGVyZXIoaXRlbSk7XG4gICAgfSk7XG4gIH1cblxuICBhZGRJbml0YWxJdGVtcyhlbGVtZW50KSB7XG4gICAgdGhpcy5fY29udGFpbmVyLmFwcGVuZChlbGVtZW50KTtcbiAgfVxuXG4gIGFkZEl0ZW1zKGVsZW1lbnQpIHtcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcbiAgfVxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gIH1cblxuICBvcGVuKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdwb3B1cF9vcGVuZWQnKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3BvcHVwX29wZW5lZCcpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBfaGFuZGxlRXNjQ2xvc2UoZXZ0KSB7XG4gICAgaWYoZXZ0LmtleSA9PT0gJ0VzY2FwZScpIHtcbiAgICAgIHJldHVybiB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9XG5cbiAgX2hhbmRsZU91dHNpZGVDbGljayhldnQpIHtcbiAgICBpZihldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygncG9wdXBfX3NlY3Rpb24nKSB8fCBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygncG9wdXBfX2JhY2tncm91bmQnKSkge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Nsb3NlLWJ0bicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH0pXG5cbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgKGV2dCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UoZXZ0KTtcbiAgICB9KTtcblxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldnQpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZU91dHNpZGVDbGljayhldnQpO1xuICAgIH0pO1xuICB9XG59IiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fcG9wdXBJbWFnZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuaW1hZ2UtcG9wdXBfX2ltYWdlJyk7XG4gICAgdGhpcy5fcG9wdXBUaXRsZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuaW1hZ2UtcG9wdXBfX3RpdGxlJyk7XG4gIH1cblxuICBvcGVuKHtsaW5rLCBuYW1lfSkge1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgICB0aGlzLl9wb3B1cEltYWdlLnNyYyA9IGxpbms7XG4gICAgdGhpcy5fcG9wdXBJbWFnZS5hbHQgPSBgSW1hZ2VuIGRlICR7bmFtZX1gO1xuICAgIHRoaXMuX3BvcHVwVGl0bGUudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cbn0iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yLCBzdWJtaXRDYWxsYmFjayB9KSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fZm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZm9ybScpO1xuICAgIHRoaXMuX2J1dHRvblN1Ym1pdCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2J0bicpXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IHN1Ym1pdENhbGxiYWNrO1xuICB9XG5cbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIHRoaXMuX2lucHV0TGlzdCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbCgnLmZvcm1fX2lucHV0Jyk7XG4gICAgdGhpcy5mb3JtVmFsdWVzID0ge307XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICB0aGlzLmZvcm1WYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcbiAgICB9KTtcbiAgICByZXR1cm4gdGhpcy5mb3JtVmFsdWVzO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9KTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHN1cGVyLmNsb3NlKCk7XG4gICAgdGhpcy5fZm9ybS5yZXNldCgpO1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2J0bicpLmNsYXNzTGlzdC5hZGQoJ3BvcHVwX19idG5faW5hY3RpdmUnKTtcbiAgfVxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IoeyBuYW1lU2VsZWN0b3IsIGFib3V0U2VsZWN0b3IsIGF2YXRhclNlbGVjdG9yLCB1c2VySUQgfSkge1xuICAgIHRoaXMuX3VzZXJuYW1lID0gbmFtZVNlbGVjdG9yO1xuICAgIHRoaXMuX2Fib3V0ID0gYWJvdXRTZWxlY3RvcjtcbiAgICB0aGlzLl9hdmF0YXJTZWxlY3RvciA9ICBhdmF0YXJTZWxlY3RvcjtcbiAgICB0aGlzLl91c2VySUQgPSB1c2VySUQ7XG5cbiAgICB0aGlzLl9uYW1lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbmFtZS1pbnB1dCcpO1xuICAgIHRoaXMuX2Fib3V0SW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjYWJvdXQtaW5wdXQnKTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiB0aGlzLl9uYW1lSW5wdXQudGV4dENvbnRlbnQsXG4gICAgICBhYm91dDogdGhpcy5fam9iSW5wdXQudGV4dENvbnRlbnRcbiAgICB9O1xuICB9XG5cbiAgc2V0VXNlckluZm8oZGF0YSkge1xuICAgIGNvbnN0IHt1c2VybmFtZSwgYWJvdXR9ID0gZGF0YVxuICAgIHRoaXMuX3VzZXJuYW1lLnRleHRDb250ZW50ID0gdXNlcm5hbWU7XG4gICAgdGhpcy5fYWJvdXQudGV4dENvbnRlbnQgPSBhYm91dDtcbiAgfVxuXG4gIHNldFVzZXJBdmF0YXIoYXZhdGFyKSB7XG4gICAgdGhpcy5fYXZhdGFyU2VsZWN0b3Iuc3JjID0gYXZhdGFyXG4gIH1cbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xuICBjb25zdHJ1Y3Rvcih7YmFzZVVSTCwgaGVhZGVyc30pIHtcbiAgICB0aGlzLl9iYXNlVVJMID0gYmFzZVVSTDtcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcbiAgfVxuXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVSTH0vY2FyZHNgLCB7XG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXG4gICAgfSlcbiAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgaWYocmVzLm9rKSB7XG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgICAgfSk7XG4gIH1cblxuICBhZGROZXdDYXJkKG5hbWUsIGxpbmspIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVSTH0vY2FyZHNgLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgbGluazogbGlua1xuICAgICAgfSlcbiAgICB9KVxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICBpZihyZXMub2spIHtcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgICB9KTtcbiAgfVxuXG4gIGRlbGV0ZUNhcmQoY2FyZElEKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVUkx9L2NhcmRzLyR7Y2FyZElEfWAsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSlcbiAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgaWYocmVzLm9rKSB7XG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgICAgfSk7XG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVSTH0vdXNlcnMvbWVgLCB7XG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXG4gICAgfSlcbiAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgaWYocmVzLm9rKSB7XG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgICAgfSk7XG4gIH1cblxuICBlZGl0UHJvZmlsZUluZm8obmFtZSwgYWJvdXQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVSTH0vdXNlcnMvbWVgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgIGFib3V0OiBhYm91dFxuICAgICAgfSlcbiAgICB9KVxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICBpZihyZXMub2spIHtcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgICB9KTtcbiAgfVxuXG4gIGFkZExpa2UoY2FyZElEKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVUkx9L2NhcmRzL2xpa2VzLyR7Y2FyZElEfWAsIHtcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcbiAgICB9KVxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICBpZihyZXMub2spIHtcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgICB9KTtcbiAgfVxuXG4gIGRlbGV0ZUxpa2UoY2FyZElEKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVUkx9L2NhcmRzL2xpa2VzLyR7Y2FyZElEfWAsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcbiAgICB9KVxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICBpZihyZXMub2spIHtcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgICB9KTtcbiAgfVxuXG4gIGF2YXRhckltYWdlKGxpbmspIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVSTH0vdXNlcnMvbWUvYXZhdGFyYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBhdmF0YXI6IGxpbmtcbiAgICAgIH0pXG4gICAgfSlcbiAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgaWYocmVzLm9rKSB7XG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgICAgfSk7XG4gIH1cbn0iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoQ29uZmlybWF0aW9uIGV4dGVuZHMgUG9wdXB7XG4gIGNvbnN0cnVjdG9yKHtwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0LCBzdWJtaXRCdXR0b259KSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gc3VibWl0QnV0dG9uO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgICB0aGlzLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xuICB9XG5cbiAgc2V0U3VibWl0QWN0aW9uKGFjdGlvbikge1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBhY3Rpb247XG4gIH1cblxuICByZW5kZXJMb2FkaW5nKGlzTG9hZGluZykge1xuICAgIGlmIChpc0xvYWRpbmcpIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9ICdHdWFyZGFuZG8uLi4nO1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQoJ3BvcHVwX19idG5faW5hY3RpdmUnKVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSAnU8OtJztcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKCdwb3B1cF9fYnRuX2luYWN0aXZlJylcbiAgICB9XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCgpO1xuICAgICAgdGhpcy5yZW5kZXJMb2FkaW5nKHRydWUpO1xuICAgIH0pO1xuICB9XG59IiwiaW1wb3J0ICcuL2luZGV4LmNzcyc7XG5cbmltcG9ydCBDYXJkIGZyb20gJy4uL2NvbXBvbmVudHMvQ2FyZC5qcyc7XG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tICcuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMnO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSAnLi4vY29tcG9uZW50cy9TZWN0aW9uJztcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tICcuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlJztcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gJy4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybSc7XG5pbXBvcnQgVXNlckluZm8gZnJvbSAnLi4vY29tcG9uZW50cy9Vc2VySW5mbyc7XG5pbXBvcnQgQXBpIGZyb20gJy4uL2NvbXBvbmVudHMvQXBpJztcbmltcG9ydCBQb3B1cFdpdGhDb25maXJtYXRpb24gZnJvbSAnLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24nO1xuXG4vL0dlbmVyYWxcbmNvbnN0IHJvb3RFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnJvb3QnKTtcbmNvbnN0IHBhZ2VDb250YWluZXIgPSByb290RWxlbWVudC5xdWVyeVNlbGVjdG9yKCcucGFnZScpO1xuXG4vL1Byb2ZpbGUgY29udGFpbmVyXG5leHBvcnQgY29uc3QgcHJvZmlsZUF1dGhvciA9IHBhZ2VDb250YWluZXIucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2F1dGhvcicpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVBYm91dCA9IHBhZ2VDb250YWluZXIucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2Fib3V0LW1lJyk7XG5jb25zdCBwcm9maWxlQXZhdGFyQ29udGFpbmVyID0gcGFnZUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fY29udGFpbmVyJyk7XG5jb25zdCBwcm9maWxlQXZhdGFyID0gcGFnZUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcjcG9wdXBfX2F2YXRhci1pbWFnZScpXG5cbi8vIFBvcHVwIHByb2ZpbGVcbmNvbnN0IHByb2ZpbGVDb250YWluZXIgPSBwYWdlQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJyNwb3B1cF9fcHJvZmlsZS1mb3JtJyk7XG5leHBvcnQgY29uc3QgcG9wdXBQcm9maWxlID0gcGFnZUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcjcG9wdXBfX3Byb2ZpbGUnKTtcbmV4cG9ydCBjb25zdCBpbnB1dFByb2ZpbGVOYW1lID0gcHJvZmlsZUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcjbmFtZS1pbnB1dCcpO1xuZXhwb3J0IGNvbnN0IGlucHV0UHJvZmlsZUFib3V0ID0gcHJvZmlsZUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcjYWJvdXQtaW5wdXQnKTtcbmV4cG9ydCBjb25zdCBjbG9zZVByb2ZpbGVCdG4gPSBwb3B1cFByb2ZpbGUucXVlcnlTZWxlY3RvcignLnBvcHVwX19wcm9maWxlLWNsb3NlLWJ0bicpO1xuZXhwb3J0IGNvbnN0IGVkaXRQcm9maWxlQnRuID0gcGFnZUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fZWRpdC1idG4nKTtcbmV4cG9ydCBjb25zdCBzdWJtaXRQcm9maWxlQnRuID0gcG9wdXBQcm9maWxlLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fYnRuJyk7XG5cbi8vIFBvcHVwIHBsYWNlXG5leHBvcnQgY29uc3QgcGxhY2VzQ29udGFpbmVyID0gcGFnZUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcjcG9wdXBfX3BsYWNlcy1mb3JtJyk7XG5leHBvcnQgY29uc3QgcG9wdXBQbGFjZXMgPSBwYWdlQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJyNwb3B1cF9fY2FyZHMnKTtcbmV4cG9ydCBjb25zdCBjbG9zZVBsYWNlc0J0biA9IHBvcHVwUGxhY2VzLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fcGxhY2VzLWNsb3NlLWJ0bicpO1xuZXhwb3J0IGNvbnN0IGFkZENhcmRCdG4gPSBwYWdlQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19hZGQtYnRuJyk7XG5leHBvcnQgY29uc3QgaW5wdXRQbGFjZU5hbWUgPSBwbGFjZXNDb250YWluZXIucXVlcnlTZWxlY3RvcignLnBvcHVwX19wbGFjZScpO1xuZXhwb3J0IGNvbnN0IGlucHV0UGxhY2VMaW5rID0gcGxhY2VzQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fdXJsJyk7XG5jb25zdCBzdWJtaXRQbGFjZXNCdG4gPSBwbGFjZXNDb250YWluZXIucXVlcnlTZWxlY3RvcignLnBvcHVwX19idG4nKTtcblxuLy8gUG9wdXAgaW1hZ2VcbmV4cG9ydCBjb25zdCBwb3B1cEltYWdlID0gcGFnZUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcjaW1hZ2UtcG9wdXAnKTtcblxuZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2NvbnRhaW5lcicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICBjb25zdCBwcnVlYmEgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcG9wdXBfX2F2YXRhci1pbWFnZScpO1xuICBwcnVlYmEuY2xhc3NMaXN0LmFkZCgncG9wdXBfb3BlbmVkJyk7XG59KVxuXG4vLyBJbml0aWFsIGNhcmRzXG5jb25zdCBpbml0aWFsQ2FyZHMgPSBbXG4gIHtcbiAgICBuYW1lOiAnVmFsbGUgZGUgWW9zZW1pdGUnLFxuICAgIGxpbms6ICdodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL25ldy1tYXJrZXRzL1dFQl9zcHJpbnRfNS9FUy95b3NlbWl0ZS5qcGcnXG4gIH0sXG4gIHtcbiAgICBuYW1lOiAnTGFnbyBMb3Vpc2UnLFxuICAgIGxpbms6ICdodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL25ldy1tYXJrZXRzL1dFQl9zcHJpbnRfNS9FUy9sYWtlLWxvdWlzZS5qcGcnXG4gIH0sXG4gIHtcbiAgICBuYW1lOiAnTW9udGHDsWFzIENhbHZhcycsXG4gICAgbGluazogJ2h0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vbmV3LW1hcmtldHMvV0VCX3NwcmludF81L0VTL2JhbGQtbW91bnRhaW5zLmpwZydcbiAgfSxcbiAge1xuICAgIG5hbWU6ICdMYXRlbWFyJyxcbiAgICBsaW5rOiAnaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9uZXctbWFya2V0cy9XRUJfc3ByaW50XzUvRVMvbGF0ZW1hci5qcGcnXG4gIH0sXG4gIHtcbiAgICBuYW1lOiAnUGFycXVlIE5hY2lvbmFsIGRlIGxhIFZhbm9pc2UnLFxuICAgIGxpbms6ICdodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL25ldy1tYXJrZXRzL1dFQl9zcHJpbnRfNS9FUy92YW5vaXNlLmpwZydcbiAgfSxcbiAge1xuICAgIG5hbWU6ICdMYWdvIGRpIEJyYWllcycsXG4gICAgbGluazogJ2h0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vbmV3LW1hcmtldHMvV0VCX3NwcmludF81L0VTL2xhZ28uanBnJ1xuICB9XG5dO1xuXG4vLyBOdWV2byBDb2RpZ29cbmNvbnN0IHByb2ZpbGVJbmZvID0gbmV3IFVzZXJJbmZvKHtcbiAgbmFtZVNlbGVjdG9yOiBwcm9maWxlQXV0aG9yLFxuICBhYm91dFNlbGVjdG9yOiBwcm9maWxlQWJvdXQsXG4gIGF2YXRhclNlbGVjdG9yOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fcGhvdG8nKVxufSk7XG5cbmNvbnN0IHJlbW92ZUNhcmQgPSBuZXcgUG9wdXBXaXRoQ29uZmlybWF0aW9uKHtcbiAgcG9wdXBTZWxlY3RvcjogJyNwb3B1cF9fZGVsZXRlJyxcbiAgc3VibWl0QnV0dG9uOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2NvbmZpcm0tYnRuJylcbn0pO1xuXG5jb25zdCBpbWFnZVBvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKCcjaW1hZ2UtcG9wdXAnKTtcbmltYWdlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxucmVtb3ZlQ2FyZC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgYmFzZVVSTDogJ2h0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvd2ViX2VzXzA3JyxcbiAgaGVhZGVyczoge1xuICAgIGF1dGhvcml6YXRpb246ICdiN2U3MTI4NC00MDIwLTQ0ZjQtYTgwZi00MzcyMmM1YjNlY2UnLFxuICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgfVxufSk7XG5cbmNvbnN0IGVkaXRQcm9maWxlID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xuICBwb3B1cFNlbGVjdG9yOiAnI3BvcHVwX19wcm9maWxlJyxcbiAgc3VibWl0Q2FsbGJhY2s6IChkYXRhKSA9PiB7XG4gICAgYXBpXG4gICAgICAuZWRpdFByb2ZpbGVJbmZvKGRhdGEubmFtZSwgZGF0YS5hYm91dClcbiAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgcHJvZmlsZUluZm8uc2V0VXNlckluZm8oe3VzZXJuYW1lOiByZXMubmFtZSwgYWJvdXQ6IHJlcy5hYm91dH0pO1xuICAgICAgICBlZGl0UHJvZmlsZS5jbG9zZSgpXG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSlcbiAgfVxufSk7XG5lZGl0UHJvZmlsZS5zZXRFdmVudExpc3RlbmVycygpO1xuXG5hcGkuZ2V0VXNlckluZm8oKS50aGVuKChyZXMpID0+IHtcbiAgcHJvZmlsZUluZm8uc2V0VXNlckluZm8oe3VzZXJuYW1lOiByZXMubmFtZSwgYWJvdXQ6IHJlcy5hYm91dH0pO1xuICAvKnByb2ZpbGVJbmZvLnNldFVzZXJBdmF0YXIocmVzLmF2YXRhcik7Ki9cbiAgcHJvZmlsZUluZm8udXNlcklEID0gcmVzLl9pZDtcbn0pXG4udGhlbigoKSA9PiB7XG4gIGFwaS5nZXRJbml0aWFsQ2FyZHMoKS50aGVuKChyZXMpID0+IHtcbiAgICBjb25zdCBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKHtcbiAgICAgIGRhdGE6IHJlcyxcbiAgICAgIHJlbmRlcmVyOiAoZGF0YSkgPT4ge1xuICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoZGF0YSk7XG4gICAgICAgIGNhcmRTZWN0aW9uLmFkZEluaXRhbEl0ZW1zKGNhcmRFbGVtZW50KTtcbiAgICAgIH1cbiAgICB9LCAnI2VsZW1lbnRzJylcblxuICAgIGNhcmRTZWN0aW9uLnJlbmRlcmVkSXRlbXMoKTtcblxuICAgIGNvbnN0IGFkZENhcmQgPSBuZXcgUG9wdXBXaXRoRm9ybSh7XG4gICAgICBwb3B1cFNlbGVjdG9yOiAnI3BvcHVwX19jYXJkcycsXG4gICAgICBzdWJtaXRDYWxsYmFjazogKGRhdGEpID0+IHtcbiAgICAgICAgYXBpXG4gICAgICAgICAgLmFkZE5ld0NhcmQoZGF0YS5uYW1lLCBkYXRhLmxpbmspXG4gICAgICAgICAgLnRoZW4oKGNhcmQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG5ld0NhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChjYXJkKTtcbiAgICAgICAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW1zKG5ld0NhcmRFbGVtZW50KTtcbiAgICAgICAgICAgIGFkZENhcmQuY2xvc2UoKTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGFkZENhcmQuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuICB9KVxufSlcblxuZnVuY3Rpb24gY3JlYXRlQ2FyZChkYXRhKSB7XG4gIGNvbnN0IG5ld0NhcmQgPSBuZXcgQ2FyZChkYXRhICwgJyNlbGVtZW50LXRlbXBsYXRlJywge1xuICAgIGhhbmRsZUNhcmRDbGljazooe25hbWUsIGxpbmt9KSA9PiB7XG4gICAgICBpbWFnZVBvcHVwLm9wZW4oe25hbWUsIGxpbmt9KVxuICAgIH0sXG4gICAgaGFuZGxlRGVsZXRlQ2xpY2s6ICh7aWR9KSA9PiB7XG4gICAgICByZW1vdmVDYXJkLm9wZW4oKTtcbiAgICAgIHJlbW92ZUNhcmQuc2V0U3VibWl0QWN0aW9uKCgpID0+IHtcbiAgICAgICAgYXBpLmRlbGV0ZUNhcmQoaWQpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgIHJlbW92ZUNhcmQuY2xvc2UoKTtcbiAgICAgICAgICBuZXdDYXJkLl90cmFzaEJ0bigpO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XG4gICAgICB9KTtcbiAgICB9LFxuICAgIGhhbmRsZUFkZExpa2U6ICh7aWR9KSA9PiB7XG4gICAgICBhcGkuYWRkTGlrZShpZCkudGhlbigocmVzKSA9PiB7XG4gICAgICAgIG5ld0NhcmQudXBkYXRlTGlrZXMocmVzLmxpa2VzKTtcbiAgICAgICAgbmV3Q2FyZC5hZGRMaWtlRmlsdGVyKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpO1xuICAgIH0sXG4gICAgaGFuZGxlUmVtb3ZlTGlrZTogKHtpZH0pID0+IHtcbiAgICAgIGFwaS5kZWxldGVMaWtlKGlkKS50aGVuKChyZXMpID0+IHtcbiAgICAgICAgbmV3Q2FyZC51cGRhdGVMaWtlcyhyZXMubGlrZXMpO1xuICAgICAgICBuZXdDYXJkLl9yZW1vdmVMaWtlKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpO1xuICAgIH0sXG4gICAgdXNlcklEOiBwcm9maWxlSW5mby51c2VySURcbiAgfSk7XG4gIHJldHVybiBuZXdDYXJkLmdlbmVyYXRlQ2FyZCgpO1xufTtcblxuLy8gUmVuZGVyIGluaXRpYWwgY2FyZHNcbi8qY29uc3QgaW5pdGlhbENhcmRMaXN0ID0gbmV3IFNlY3Rpb24oe1xuICBkYXRhOiBpbml0aWFsQ2FyZHMsXG4gIHJlbmRlcmVyOiAoaXRlbSkgPT4ge1xuICAgIGNvbnN0IGRlZmF1bHRDYXJkID0gbmV3IENhcmQoaXRlbSwgJyNlbGVtZW50LXRlbXBsYXRlJywge1xuICAgICAgaGFuZGxlQ2FyZENsaWNrOiAobGluaywgbmFtZSkgPT4ge1xuICAgICAgICBjb25zdCBwb3B1cEltYWdlID0gbmV3IFBvcHVwV2l0aEltYWdlKCcjaW1hZ2UtcG9wdXAnLCBsaW5rLCBuYW1lKTtcbiAgICAgICAgcG9wdXBJbWFnZS5vcGVuKCk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgY29uc3QgZGVmYXVsdEVsZW1lbnRDYXJkID0gZGVmYXVsdENhcmQuZ2VuZXJhdGVDYXJkKCk7XG4gICAgaW5pdGlhbENhcmRMaXN0LmFkZEluaXRhbEl0ZW1zKGRlZmF1bHRFbGVtZW50Q2FyZCk7XG4gIH1cbn0sICcjZWxlbWVudHMnKTtcblxuaW5pdGlhbENhcmRMaXN0LnJlbmRlcmVkSXRlbXMoKTtcblxuLy8gQ3JlYXRlIG5ldyBjYXJkc1xuZnVuY3Rpb24gY3JlYXRlQ2FyZHMoaXRlbSkge1xuICBjb25zdCBjYXJkID0gbmV3IENhcmQoaXRlbSwgJyNlbGVtZW50LXRlbXBsYXRlJywge1xuICAgIGhhbmRsZUNhcmRDbGljazogKGxpbmssIG5hbWUpID0+IHtcbiAgICAgIGNvbnN0IGltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoJyNpbWFnZS1wb3B1cCcsIGxpbmssIG5hbWUpO1xuICAgICAgaW1hZ2VQb3B1cC5vcGVuKCk7XG4gICAgfSxcbiAgfSk7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZC5nZW5lcmF0ZUNhcmQoKTtcbiAgaW5pdGlhbENhcmRMaXN0LmFkZEl0ZW1zKGNhcmRFbGVtZW50KTtcbn1cblxuY29uc3QgY2FyZHNGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xuICBwb3B1cFNlbGVjdG9yOiAnI3BvcHVwX19jYXJkcycsXG4gIHN1Ym1pdENhbGxiYWNrOiAoaXRlbSkgPT4ge1xuICAgIGNyZWF0ZUNhcmRzKGl0ZW0pO1xuICAgIGNhcmRzRm9ybS5jbG9zZSgpO1xuICB9XG59KTtcblxuY2FyZHNGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbi8vIENoYW5nZSB1c2VyIGluZm9ybWF0aW9uXG4vKmNvbnN0IHVzZXJJbmZvUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybSh7XG4gIHBvcHVwU2VsZWN0b3I6ICcjcG9wdXBfX3Byb2ZpbGUnLFxuICBzdWJtaXRDYWxsYmFjazogKCkgPT4ge1xuICAgIGNvbnN0IHNldEluZm8gPSBuZXcgVXNlckluZm8oe1xuICAgICAgbmFtZVNlbGVjdG9yOiBwcm9maWxlQXV0aG9yLFxuICAgICAgYWJvdXRTZWxlY3RvcjogcHJvZmlsZUFib3V0XG4gICAgfSlcbiAgICBzZXRJbmZvLnNldFVzZXJJbmZvKCk7XG4gIH1cbn0pO1xuXG51c2VySW5mb1BvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7Ki9cblxuY29uc3QgdG9nZ2xlQWRkQ2FyZHNQb3B1cCA9ICgpID0+IHtcbiAgcG9wdXBQbGFjZXMuY2xhc3NMaXN0LnRvZ2dsZSgncG9wdXBfb3BlbmVkJyk7XG59XG5cbmFkZENhcmRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0b2dnbGVBZGRDYXJkc1BvcHVwKTtcblxuY29uc3Qgb3BlblByb2ZpbGVQb3B1cCA9ICgpID0+IHtcbiAgcG9wdXBQcm9maWxlLmNsYXNzTGlzdC5hZGQoJ3BvcHVwX29wZW5lZCcpO1xuICBzdWJtaXRQcm9maWxlQnRuLmNsYXNzTGlzdC5hZGQoJ3BvcHVwX19idG5faW5hY3RpdmUnKTtcbn1cblxuZWRpdFByb2ZpbGVCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvcGVuUHJvZmlsZVBvcHVwKTtcblxuLypleHBvcnQgZnVuY3Rpb24gY3JlYXRlTmV3Q2FyZChjYXJkKSB7XG4gIGNvbnN0IG5ld0NhcmQgPSBuZXcgQ2FyZChjYXJkLCAnI2VsZW1lbnQtdGVtcGxhdGUnKTtcbiAgY29uc3QgbmV3Q2FyZEVsZW1lbnQgPSBuZXdDYXJkLmdlbmVyYXRlQ2FyZCgpO1xuXG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNlbGVtZW50cycpLnByZXBlbmQobmV3Q2FyZEVsZW1lbnQpO1xufSovXG5cbi8vIElucHV0IHZhbGlkYXRpb25zXG5jb25zdCB2YWxpZGF0aW9uID0gbmV3IEZvcm1WYWxpZGF0b3IoZG9jdW1lbnQpO1xudmFsaWRhdGlvbi5lbmFibGVWYWxpZGF0aW9uKCk7Il0sIm5hbWVzIjpbIkNhcmQiLCJkYXRhIiwiY2FyZFNlbGVjdG9yIiwiX3JlZiIsIl90aGlzIiwiaGFuZGxlQ2FyZENsaWNrIiwiaGFuZGxlRGVsZXRlQ2xpY2siLCJoYW5kbGVBZGRMaWtlIiwiaGFuZGxlUmVtb3ZlTGlrZSIsInVzZXJJRCIsIl9jbGFzc0NhbGxDaGVjayIsInJlc0FycmF5IiwiX2xpa2VzQXJyYXkiLCJ0aGlzIiwiX25hbWUiLCJuYW1lIiwiX2xpbmsiLCJsaW5rIiwiX2lkIiwibGlrZXMiLCJfY2FyZExpa2VzIiwibGVuZ3RoIiwiX293bmVySWQiLCJvd25lciIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlQ2FyZENsaWNrIiwiX2hhbmRsZURlbGV0ZUNsaWNrIiwiX2hhbmRsZUFkZExpa2UiLCJfaGFuZGxlUmVtb3ZlTGlrZSIsIl91c2VyIiwia2V5IiwidmFsdWUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX3RoaXMyIiwiX2VsZW1lbnQiLCJfZ2V0VGVtcGxhdGUiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJ0ZXh0Q29udGVudCIsInNyYyIsImFsdCIsImNvbmNhdCIsImhhc1VzZXJMaWtlZCIsInNvbWUiLCJsaWtlIiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwiX3RoaXMzIiwiYWRkRXZlbnRMaXN0ZW5lciIsImNvbnNvbGUiLCJsb2ciLCJpZCIsIl9vcGVuSW1hZ2VQb3B1cCIsInJlbW92ZSIsImFkZCIsImNsb3Nlc3QiLCJGb3JtVmFsaWRhdG9yIiwiX2NyZWF0ZUNsYXNzIiwidmFsaWRhdGlvbiIsIl9kZWZpbmVQcm9wZXJ0eSIsImZvcm1FbGVtZW50IiwiaW5wdXRFbGVtZW50IiwiZXJyb3JNZXNzYWdlIiwiZXJyb3JFbGVtZW50IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oaWRlSW5wdXRFcnJvciIsIl9zaG93SW5wdXRFcnJvciIsInZhbGlkYXRpb25NZXNzYWdlIiwiaW5wdXRMaXN0IiwiYnV0dG9uRWxlbWVudCIsIl9oYXNJbnZhbGlkSW5wdXQiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiZm9yRWFjaCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsImZpZWxkc2V0IiwiX3ZhbGlkYXRpb24iLCJTZWN0aW9uIiwiY29udGFpbmVyU2VsZWN0b3IiLCJyZW5kZXJlciIsIl9kYXRhQXJyYXkiLCJfY29udGFpbmVyIiwiaXRlbSIsImVsZW1lbnQiLCJhcHBlbmQiLCJwcmVwZW5kIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIl9oYW5kbGVFc2NDbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJjbG9zZSIsInRhcmdldCIsImNvbnRhaW5zIiwiX2hhbmRsZU91dHNpZGVDbGljayIsIlBvcHVwV2l0aEltYWdlIiwiX1BvcHVwIiwiX2luaGVyaXRzIiwiX3N1cGVyIiwiY2FsbCIsIl9wb3B1cEltYWdlIiwiX3BvcHVwVGl0bGUiLCJfZ2V0IiwiX2dldFByb3RvdHlwZU9mIiwicHJvdG90eXBlIiwiUG9wdXBXaXRoRm9ybSIsInN1Ym1pdENhbGxiYWNrIiwiX2Zvcm0iLCJfYnV0dG9uU3VibWl0IiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfaW5wdXRMaXN0IiwiZm9ybVZhbHVlcyIsImlucHV0IiwiX2dldElucHV0VmFsdWVzIiwicmVzZXQiLCJVc2VySW5mbyIsIm5hbWVTZWxlY3RvciIsImFib3V0U2VsZWN0b3IiLCJhdmF0YXJTZWxlY3RvciIsIl91c2VybmFtZSIsIl9hYm91dCIsIl9hdmF0YXJTZWxlY3RvciIsIl91c2VySUQiLCJfbmFtZUlucHV0IiwiX2Fib3V0SW5wdXQiLCJhYm91dCIsIl9qb2JJbnB1dCIsInVzZXJuYW1lIiwiYXZhdGFyIiwiQXBpIiwiYmFzZVVSTCIsImhlYWRlcnMiLCJfYmFzZVVSTCIsIl9oZWFkZXJzIiwiZmV0Y2giLCJtZXRob2QiLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiY2FyZElEIiwiUG9wdXBXaXRoQ29uZmlybWF0aW9uIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1Ym1pdEJ1dHRvbiIsIl9zdWJtaXRCdXR0b24iLCJyZW5kZXJMb2FkaW5nIiwiYWN0aW9uIiwiaXNMb2FkaW5nIiwicGFnZUNvbnRhaW5lciIsInByb2ZpbGVBdXRob3IiLCJwcm9maWxlQWJvdXQiLCJwcm9maWxlQ29udGFpbmVyIiwicG9wdXBQcm9maWxlIiwiZWRpdFByb2ZpbGVCdG4iLCJzdWJtaXRQcm9maWxlQnRuIiwicGxhY2VzQ29udGFpbmVyIiwicG9wdXBQbGFjZXMiLCJhZGRDYXJkQnRuIiwicHJvZmlsZUluZm8iLCJyZW1vdmVDYXJkIiwiaW1hZ2VQb3B1cCIsInNldEV2ZW50TGlzdGVuZXJzIiwiYXBpIiwiYXV0aG9yaXphdGlvbiIsImVkaXRQcm9maWxlIiwiZWRpdFByb2ZpbGVJbmZvIiwic2V0VXNlckluZm8iLCJjYXRjaCIsImVyciIsImNyZWF0ZUNhcmQiLCJuZXdDYXJkIiwib3BlbiIsIl9yZWYyIiwic2V0U3VibWl0QWN0aW9uIiwiZGVsZXRlQ2FyZCIsIl90cmFzaEJ0biIsIl9yZWYzIiwiYWRkTGlrZSIsInVwZGF0ZUxpa2VzIiwiYWRkTGlrZUZpbHRlciIsIl9yZWY0IiwiZGVsZXRlTGlrZSIsIl9yZW1vdmVMaWtlIiwiZ2VuZXJhdGVDYXJkIiwiZ2V0VXNlckluZm8iLCJnZXRJbml0aWFsQ2FyZHMiLCJjYXJkU2VjdGlvbiIsImNhcmRFbGVtZW50IiwiYWRkSW5pdGFsSXRlbXMiLCJyZW5kZXJlZEl0ZW1zIiwiYWRkQ2FyZCIsImFkZE5ld0NhcmQiLCJjYXJkIiwibmV3Q2FyZEVsZW1lbnQiLCJhZGRJdGVtcyIsImVuYWJsZVZhbGlkYXRpb24iXSwic291cmNlUm9vdCI6IiJ9